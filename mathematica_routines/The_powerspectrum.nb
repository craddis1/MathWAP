(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     79002,       2074]
NotebookOptionsPosition[     73019,       1963]
NotebookOutlinePosition[     73482,       1981]
CellTagsIndexPosition[     73439,       1978]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["", "PageBreak",
 PageBreakBelow->True,ExpressionUUID->"c5330af3-aca8-4af7-9a6c-9cd2240f3d59"],

Cell[BoxData[
 RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8906189356595592`*^9, 3.8906189523446608`*^9}, {
  3.890711089935755*^9, 3.890711091410549*^9}, {3.903441148311184*^9, 
  3.9034411554663897`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"700ee33e-1921-483b-af19-a8175b0c8fb4"],

Cell[CellGroupData[{

Cell["Multi-tracer  local power spectrum", "Title",
 CellChangeTimes->{{3.936107153448099*^9, 3.9361071792166853`*^9}, {
  3.9482958482843523`*^9, 
  3.948295849840197*^9}},ExpressionUUID->"0b657c16-37b0-46a4-b101-\
bb63b9662db7"],

Cell[CellGroupData[{

Cell["Load in modules", "Subsubsection",
 CellChangeTimes->{{3.936107218962881*^9, 
  3.936107225237112*^9}},ExpressionUUID->"8f359d76-3d46-4abe-b7a1-\
ad8a63f189d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Load", " ", "in", " ", "expressions", " ", "to", " ", "calculate", " ", 
     "and", " ", "simplify", " ", "the", " ", "wide"}], "-", 
    RowBox[{"separation", " ", "expansion"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/Pk_expansions.nb\>\"", 
      ",", 
      RowBox[{"EvaluationElements", "->", "\"\<InitializationCell\>\""}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Load", " ", "in", " ", "wide", " ", "separation", " ", "expansions"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/Pk_funcsandrules.nb\>\"", 
      ",", 
      RowBox[{"EvaluationElements", "->", "\"\<InitializationCell\>\""}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"load", " ", "kernels"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/kernels.nb\>\"", ",", 
      RowBox[{"EvaluationElements", "->", "\"\<InitializationCell\>\""}]}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.930225230373597*^9, 3.930225247085586*^9}, {
  3.93028674661446*^9, 3.9302867769827137`*^9}, {3.930287053596716*^9, 
  3.930287057657045*^9}, {3.930388533945277*^9, 3.9303885343594837`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"298a57c3-5d10-48c1-aa6d-d410276c0b29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect first order redshift kernels for two tracers", "Subsubsection",
 CellChangeTimes->{{3.936107233651243*^9, 
  3.9361072905336313`*^9}},ExpressionUUID->"fdb0acc9-8265-4e87-bd42-\
891d24a960cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "define", " ", "complete", " ", "kernels", " ", "Newtonian", " ", "plus", 
    " ", "GR"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"K1", "[", 
     RowBox[{"q1_", ",", "x1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"KN1", "[", 
      RowBox[{"q1", ",", "x1"}], "]"}], "+", 
     RowBox[{"KGR1", "[", 
      RowBox[{"q1", ",", "x1"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"for", " ", "multi", " ", "tracer"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K1a", "[", 
     RowBox[{"q1_", ",", "x1_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"K1", "[", 
      RowBox[{"q1", ",", "x1"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"b1", "->", "xb1"}], ",", 
       RowBox[{"gr1", "->", "xgr1"}], ",", 
       RowBox[{"gr2", "->", "xgr2"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"complete", " ", "terms", " ", "of", " ", "RSD", " ", "P", 
     RowBox[{"(", "k", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RSDpk", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"K1", "[", 
        RowBox[{"q1", ",", "x1"}], "]"}], 
       RowBox[{"K1a", "[", 
        RowBox[{
         RowBox[{"-", "q1"}], ",", "x2"}], "]"}], 
       RowBox[{"P", "[", 
        RowBox[{"Norm", "[", "q1", "]"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "q1"}], ")"}], ".", "x2"}], "->", 
         RowBox[{"-", 
          RowBox[{"q1", ".", "x2"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "q1"}], ")"}], ".", "x1"}], "->", 
         RowBox[{"-", 
          RowBox[{"q1", ".", "x1"}]}]}]}], "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.890618757626*^9, 3.8906188425643044`*^9}, 
   3.8906189787969093`*^9, {3.890632253867159*^9, 3.890632269673169*^9}, 
   3.890632585322938*^9, {3.890634529370905*^9, 3.890634534000339*^9}, {
   3.89064466355474*^9, 3.89064466721472*^9}, {3.8949519294090767`*^9, 
   3.894952028734229*^9}, 3.899271499326219*^9, 3.899271807293992*^9, 
   3.899787988354803*^9, {3.8997981566273727`*^9, 3.8997981594241667`*^9}, 
   3.900259942100425*^9, {3.9077643737363167`*^9, 3.907764384496413*^9}, {
   3.930225728566429*^9, 3.930225758742464*^9}, 3.9302953846071463`*^9, {
   3.930370406135435*^9, 3.930370406529973*^9}, {3.930388571848159*^9, 
   3.930388584496071*^9}, {3.9303891445274343`*^9, 3.9303891451364927`*^9}, {
   3.930576627442956*^9, 3.930576713644331*^9}, {3.930577570588058*^9, 
   3.930577661897235*^9}, {3.930580935056498*^9, 3.930580943939748*^9}, {
   3.9305865950600567`*^9, 3.930586597691454*^9}, {3.931586504191519*^9, 
   3.9315865144786177`*^9}, {3.931586723721731*^9, 3.931586724209489*^9}, 
   3.9315877670574827`*^9, {3.931587807862421*^9, 3.931587816508917*^9}, {
   3.931597965870468*^9, 3.931597992831265*^9}, {3.9361072980109158`*^9, 
   3.936107316635723*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2acbd79d-c899-4c6a-89b5-bc72f33f434f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get each order in H/k", "Subsection",
 CellChangeTimes->{{3.9361073571495132`*^9, 
  3.936107370054192*^9}},ExpressionUUID->"d80ad59b-d1f5-484b-8912-\
9bb52d347a48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"seperate", " ", "into", " ", "relativistic", " ", "orders"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pkfull", "=", " ", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{"RSDpk", ",", 
        RowBox[{"{", 
         RowBox[{"H", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Newt", " ", "=", " ", 
     RowBox[{"pkfull", " ", "/.", 
      RowBox[{"{", 
       RowBox[{"H", "->", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR1", " ", "=", " ", 
     RowBox[{
      RowBox[{"pkfull", " ", "-", "Newt"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"H", "^", "2"}], "->", "0"}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"(", 
      RowBox[{"H", "/", "k"}], ")"}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR2", " ", "=", " ", 
     RowBox[{"pkfull", " ", "-", " ", "Newt", " ", "-", " ", "GR1"}]}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H", "/", "k"}], ")"}], "^", "2"}], "*)"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.930388601282329*^9, 3.930388679605855*^9}, {
  3.93038893491884*^9, 3.9303889516551447`*^9}, {3.9303889877472143`*^9, 
  3.9303890027798862`*^9}, {3.930389048212421*^9, 3.930389053853644*^9}, {
  3.9305882836801863`*^9, 3.930588289679598*^9}, {3.936107328678122*^9, 
  3.93610733516381*^9}, {3.941172459526558*^9, 3.9411724642232*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"fb447f38-01e9-480b-9f79-bd172508dbff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"define", " ", "empty", " ", "dict"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pkdict", "=", 
    RowBox[{"Association", "[", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.930287098434988*^9, 3.9302871059735928`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"a4c893a7-1772-4283-9b94-5e1db6df5e4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Non-WS terms - standard plane parallel constant redshift terms\
\>", "Subsection",
 CellChangeTimes->{{3.936107398160644*^9, 3.936107430395413*^9}, {
  3.948103592884131*^9, 
  3.948103606943852*^9}},ExpressionUUID->"b4b5587b-b51f-45f6-9cc2-\
4e18187ecd14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<GR0\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Newt", "/.", 
       RowBox[{"{", 
        RowBox[{"H", "->", "1"}], "}"}]}], "/.", "removeRR"}], "/.", 
     "removeWA"}], "/.", "cleantoexport"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<GR1\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"GR1", "/.", 
       RowBox[{"{", 
        RowBox[{"H", "->", "1"}], "}"}]}], "/.", "removeRR"}], "/.", 
     "removeWA"}], "/.", "cleantoexport"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<GR2\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"GR2", "/.", 
       RowBox[{"{", 
        RowBox[{"H", "->", "1"}], "}"}]}], "/.", "removeRR"}], "/.", 
     "removeWA"}], "/.", "cleantoexport"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.93039028694239*^9, 3.930390298248992*^9}, {
  3.9303928621411*^9, 3.930392866387145*^9}, {3.9303931945863533`*^9, 
  3.930393201490739*^9}, {3.945683530701058*^9, 3.945683533213217*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"896cf271-a142-4e86-b230-be03dbcb7827"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "integrate", " ", "for", " ", "multipoles", " ", "and", " ", "export"}], 
    " ", "-", "  ", 
    RowBox[{"option", " ", "for", " ", "FOG"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getpklm", "[", 
    RowBox[{"l_", ",", "key_", ",", 
     RowBox[{"FOGFlag_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"FOGFlag", ",", 
        RowBox[{"pkltmp", "=", " ", 
         RowBox[{"integratelegendreFOG", "[", 
          RowBox[{
           RowBox[{"pkdict", "[", "key", "]"}], ",", "l"}], "]"}]}], ",", 
        RowBox[{"pkltmp", "=", 
         RowBox[{"integratelegendre", "[", 
          RowBox[{
           RowBox[{"pkdict", "[", "key", "]"}], ",", "l"}], "]"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pkltmp", " ", "=", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "  ", "l"}], "+", "1"}], ")"}], "/", "2"}], " ", 
            "DFOG", " ", 
            RowBox[{"pkdict", "[", "key", "]"}], " ", 
            RowBox[{"LegendreP", "[", 
             RowBox[{"l", ",", "\[Eta]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Eta]", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pklexport", "=", "  ", 
       RowBox[{"Simplify", "[", 
        RowBox[{"pkltmp", "/.", "cleantoexport"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"FOGFlag", ",", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
           "\"\</home/chris/Documents/Wolfram Mathematica/PkFOG\>\"", ",", 
            "\"\<l\>\"", ",", 
            RowBox[{"ToString", "[", "l", "]"}], ",", "key", ",", 
            "\"\<.json\>\""}], "]"}], ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"pklexport", ",", "InputForm"}], "]"}], ",", 
          "\"\<JSON\>\""}], "]"}], ",", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
           "\"\</home/chris/Documents/Wolfram Mathematica/Pk\>\"", ",", 
            "\"\<l\>\"", ",", 
            RowBox[{"ToString", "[", "l", "]"}], ",", "key", ",", 
            "\"\<.json\>\""}], "]"}], ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"pklexport", ",", "InputForm"}], "]"}], ",", 
          "\"\<JSON\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "pklexport"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.941775407624481*^9, {3.945682699006517*^9, 3.9456827020784187`*^9}, {
   3.945684484506049*^9, 3.945684484701985*^9}, {3.9456865933265047`*^9, 
   3.945686597273692*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"499e6a4f-d58a-4323-a43b-0426f930551f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Primordial non - Gaussian contributions", "Section",
 CellChangeTimes->{{3.941773193562929*^9, 
  3.941773216640873*^9}},ExpressionUUID->"0956e5e8-3062-4b1b-8dca-\
75b6df743a45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"KNG1", "[", 
   RowBox[{"q1_", ",", "x1_", ",", "alpha_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"KN1", "[", 
    RowBox[{"q1", ",", "x1"}], "]"}], "+", 
   RowBox[{"KN1PNG", "[", 
    RowBox[{"q1", ",", "x1", ",", "alpha"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KNG1a", "[", 
    RowBox[{"q1_", ",", "x1_", ",", "alpha_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"KN1", "[", 
      RowBox[{"q1", ",", "x1"}], "]"}], "+", 
     RowBox[{"KN1PNG", "[", 
      RowBox[{"q1", ",", "x1", ",", "alpha"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b1", "->", "xb1"}], ",", 
      RowBox[{"gr1", "->", "xgr1"}], ",", 
      RowBox[{"gr2", "->", "xgr2"}], ",", " ", 
      RowBox[{"b01", "->", "xb01"}]}], "}"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"complete", " ", "terms", " ", "of", " ", "RSD", " ", "P", 
    RowBox[{"(", "k", ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RSDpng", "[", "alpha_", "]"}], " ", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"KNG1", "[", 
      RowBox[{"q1", ",", "x1", ",", "alpha"}], "]"}], 
     RowBox[{"KNG1a", "[", 
      RowBox[{
       RowBox[{"-", "q1"}], ",", "x2", ",", "alpha"}], "]"}], 
     RowBox[{"P", "[", 
      RowBox[{"Norm", "[", "q1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "q1"}], ")"}], ".", "x2"}], "->", 
       RowBox[{"-", 
        RowBox[{"q1", ".", "x2"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "q1"}], ")"}], ".", "x1"}], "->", 
       RowBox[{"-", 
        RowBox[{"q1", ".", "x1"}]}]}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.941773260895185*^9, {3.941773383400715*^9, 3.9417733915813026`*^9}, {
   3.941773444578315*^9, 3.941773486370578*^9}, {3.941773577185273*^9, 
   3.941773591765161*^9}, 3.941773635267229*^9, {3.941774031478405*^9, 
   3.941774033072693*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"2cc9f09d-a8e7-44dc-9894-d6158dfad971"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getlinearfnl", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"temp", "=", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"{", 
          RowBox[{"fNL", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"expr0", " ", "=", 
      RowBox[{"expr", "/.", 
       RowBox[{"{", 
        RowBox[{"fNL", "->", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expr1", " ", "=", " ", 
      RowBox[{
       RowBox[{"temp", "-", "expr0"}], " ", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["fNL", 
           RowBox[{"(", 
            RowBox[{"n_", ":", "1"}], ")"}]], "/;", 
          RowBox[{"n", ">=", "2"}]}], "->", " ", "0"}], "}"}]}]}]}]}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.941774011537389*^9, 3.9417740246613607`*^9}, 
   3.94177408643434*^9},ExpressionUUID->"77e7e36d-76bc-47eb-984a-\
18480be0e7a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<Loc\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"getlinearfnl", "[", 
        RowBox[{"RSDpng", "[", "0", "]"}], "]"}], ")"}], "/.", "removeRR"}], "/.",
      "removeWA"}], "//.", "cleantoexport"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<Eq\>\"", "]"}], "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"getlinearfnl", "[", 
        RowBox[{"RSDpng", "[", "2", "]"}], "]"}], ")"}], "/.", "removeRR"}], "/.",
      "removeWA"}], "//.", "cleantoexport"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<Orth\>\"", "]"}], "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"getlinearfnl", "[", 
        RowBox[{"RSDpng", "[", "1", "]"}], "]"}], ")"}], "/.", "removeRR"}], "/.",
      "removeWA"}], "//.", "cleantoexport"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.94177409054779*^9, 3.941774113635084*^9}, {
   3.941774882920354*^9, 3.9417748881698637`*^9}, 3.941775162106536*^9, {
   3.94177519729436*^9, 3.941775203305223*^9}, {3.941775332874014*^9, 
   3.9417753466095037`*^9}, {3.941778165785529*^9, 3.941778169748674*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"ab082b71-cf3f-4d85-8fbe-c4261db27bc0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getpklm", "[", 
  RowBox[{"2", ",", "\"\<Orth\>\"", ",", "True"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getpklm", "[", 
  RowBox[{"2", ",", "\"\<Orth\>\"", ",", "False"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9417754748042707`*^9, 3.941775516093445*^9}, {
  3.941775572156794*^9, 3.9417755773543262`*^9}, {3.9417756566689997`*^9, 
  3.941775661115549*^9}, {3.941775698924963*^9, 3.941775700243586*^9}, {
  3.941775791517501*^9, 3.941775797256755*^9}, {3.941777161413677*^9, 
  3.941777166525976*^9}, {3.9417781590535173`*^9, 3.9417781835565968`*^9}, {
  3.941778255974947*^9, 3.941778257114176*^9}, {3.941778306831585*^9, 
  3.9417783165129557`*^9}, {3.94177862429926*^9, 3.9417786361601257`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"ec9366ec-e232-410d-a0d8-f763bf2b602c"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", "Mk1", " ", 
     SuperscriptBox["sigma", "5"]}]], 
   RowBox[{"5", " ", 
    SuperscriptBox["D1", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["sigma", "2"], "2"]}]], " ", "fNL", " ", "k1", " ", 
    "Pk", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "sigma", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b01", " ", "f", " ", 
          RowBox[{"(", 
           RowBox[{"9", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "b1", " ", 
          SuperscriptBox["sigma", "2"], " ", "xb01"}], "+", 
         RowBox[{"f", " ", 
          RowBox[{"(", 
           RowBox[{"9", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}], " ", "xb01"}], "+", 
         RowBox[{"3", " ", "b01", " ", 
          SuperscriptBox["sigma", "2"], " ", "xb1"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         SuperscriptBox["sigma", "2"], "2"]], " ", 
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b01", " ", "f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "9"}], "+", 
            SuperscriptBox["sigma", "2"]}], ")"}]}], "+", 
         RowBox[{"f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "9"}], "+", 
            SuperscriptBox["sigma", "2"]}], ")"}], " ", "xb01"}], "+", 
         RowBox[{"b1", " ", 
          SuperscriptBox["sigma", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            SuperscriptBox["sigma", "2"]}], ")"}], " ", "xb01"}], "+", 
         RowBox[{"b01", " ", 
          SuperscriptBox["sigma", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            SuperscriptBox["sigma", "2"]}], ")"}], " ", "xb1"}]}], ")"}], " ", 
       RowBox[{"Erf", "[", 
        FractionBox["sigma", 
         SqrtBox["2"]], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.941775518001816*^9, 3.94177553244674*^9}, 
   3.941775589883115*^9, 3.941775674979851*^9, 3.941775739180526*^9, 
   3.9417758358763866`*^9, 3.941777205027762*^9, 3.941778199595436*^9, 
   3.941778293964963*^9, 3.941778348589497*^9, 3.941778546143717*^9, 
   3.941778645956561*^9, 3.941778823413558*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"2551bed9-af33-449a-a90d-305932033081"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["D1", "2"], " ", "f", " ", "fNL", " ", "k1", " ", "Pk", " ", 
   RowBox[{"(", 
    RowBox[{"b01", "+", "xb01"}], ")"}]}], 
  RowBox[{"3", " ", "Mk1"}]]], "Output",
 CellChangeTimes->{{3.941775518001816*^9, 3.94177553244674*^9}, 
   3.941775589883115*^9, 3.941775674979851*^9, 3.941775739180526*^9, 
   3.9417758358763866`*^9, 3.941777205027762*^9, 3.941778199595436*^9, 
   3.941778293964963*^9, 3.941778348589497*^9, 3.941778546143717*^9, 
   3.941778645956561*^9, 3.9417788321369343`*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"7c318686-5be9-43a2-a20b-3def94b06b90"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Multipole Covariance", "Section",
 CellChangeTimes->{{3.94177322439167*^9, 
  3.941773237677781*^9}},ExpressionUUID->"e5c1fb14-54ed-4da4-9e48-\
7584dfa87480"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"l1", "=", "1"}], ";", 
  RowBox[{"l2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PNPP", "[", 
    RowBox[{"k_", ",", "d_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KN1", "[", 
       RowBox[{"k", ",", "d"}], "]"}], "^", "2"}], 
     RowBox[{"P", "[", 
      RowBox[{"Norm", "[", "k", "]"}], "]"}]}], "+", " ", 
    RowBox[{"1", "/", "nbar"}]}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaussint", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"LegendreP", "[", 
        RowBox[{"l1", ",", "\[Eta]"}], "]"}], 
       RowBox[{"LegendreP", "[", 
        RowBox[{"l2", ",", "\[Eta]"}], "]"}], "  ", 
       RowBox[{"PNPP", "[", 
        RowBox[{"q1", ",", "d"}], "]"}], " ", 
       RowBox[{"PNPP", "[", 
        RowBox[{"q1", ",", "d"}], "]"}]}], ")"}], "/.", "removeRR"}], "//.", 
    "cleantoexport"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"cov", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "l1"}], "+", "1"}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "l2"}], "+", "1"}], ")"}], "/", 
     RowBox[{"(", "Nk", ")"}]}], "  ", 
    RowBox[{"Integrate", "[", 
     RowBox[{"gaussint", " ", ",", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/cov\>\"", ",", 
      "\"\<l\>\"", ",", 
      RowBox[{"ToString", "[", "l1", "]"}], ",", "\"\<l\>\"", ",", 
      RowBox[{"ToString", "[", "l2", "]"}], ",", "\"\<.json\>\""}], "]"}], 
    ",", 
    RowBox[{"ToString", "[", 
     RowBox[{"cov", ",", "InputForm"}], "]"}], ",", "\"\<JSON\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.9417806975896273`*^9, {3.942740378155077*^9, 3.94274042264565*^9}, {
   3.942740973064509*^9, 3.942740976198695*^9}, {3.942741016476315*^9, 
   3.9427410204850073`*^9}, 3.942741051732559*^9, {3.942741125668668*^9, 
   3.942741128081992*^9}, {3.942741163692726*^9, 3.942741186734459*^9}, 
   3.942741276151013*^9, {3.9427413478793716`*^9, 3.94274137409951*^9}, 
   3.94450250365923*^9, {3.944502630573498*^9, 3.9445026873228607`*^9}, {
   3.944503097713313*^9, 3.944503164576867*^9}, {3.9445033136956863`*^9, 
   3.944503314587439*^9}, 3.944758113988144*^9, {3.944758211494417*^9, 
   3.944758245382596*^9}, {3.9447587096736507`*^9, 3.944758719940832*^9}, 
   3.94475879425594*^9, {3.9447588264795094`*^9, 3.9447588584561157`*^9}, {
   3.9447589595990753`*^9, 3.9447589985066643`*^9}, 3.944759745992323*^9, {
   3.948295884354342*^9, 3.94829591123811*^9}, {3.94829616373125*^9, 
   3.948296197489356*^9}, {3.9482964926191683`*^9, 3.948296523183874*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"6c0cf25f-b0fb-4fe0-80f3-3a7a60a99cdf"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2310", "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["D1", "2"], " ", "nbar", " ", "Pk", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"66", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"35", " ", 
          SuperscriptBox["b1", "2"]}], "+", 
         RowBox[{"42", " ", "b1", " ", "f"}], "+", 
         RowBox[{"15", " ", 
          SuperscriptBox["f", "2"]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["D1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1155", " ", 
          SuperscriptBox["b1", "4"]}], "+", 
         RowBox[{"2772", " ", 
          SuperscriptBox["b1", "3"], " ", "f"}], "+", 
         RowBox[{"2970", " ", 
          SuperscriptBox["b1", "2"], " ", 
          SuperscriptBox["f", "2"]}], "+", 
         RowBox[{"1540", " ", "b1", " ", 
          SuperscriptBox["f", "3"]}], "+", 
         RowBox[{"315", " ", 
          SuperscriptBox["f", "4"]}]}], ")"}], " ", "nbar", " ", "Pk"}]}], 
     ")"}]}]}], 
  RowBox[{"385", " ", 
   SuperscriptBox["nbar", "2"], " ", "Nk"}]]], "Output",
 CellChangeTimes->{{3.942741112496993*^9, 3.942741129557837*^9}, {
   3.9427411649401703`*^9, 3.942741188968289*^9}, 3.942741351301776*^9, 
   3.942741391823348*^9, {3.944758779078915*^9, 3.944758796305509*^9}, 
   3.9447588616258173`*^9, {3.944758966262291*^9, 3.94475899989887*^9}, 
   3.9447597468685493`*^9, 3.948295915180065*^9, {3.948296167573021*^9, 
   3.948296202467329*^9}, {3.9482965005370483`*^9, 3.9482965270921707`*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"ec5c545a-38c9-49d5-a80f-957babec0d0b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute WS expansion", "Section",
 CellChangeTimes->{{3.9361074403293467`*^9, 
  3.936107452895947*^9}},ExpressionUUID->"caf437df-1003-4b33-9e9a-\
0f6c32a2cb17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"get", " ", "expansions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NWA1", ",", "NWA2"}], "}"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"calculateWideAngleExpansion2", "[", 
       RowBox[{"WAexp2", ",", "Newt"}], "]"}], "/.", "removeRR"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NRR1", ",", "NRR2"}], "}"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"calculateWideAngleExpansion2", "[", 
       RowBox[{"RRexp2", ",", "Newt"}], "]"}], "/.", "removeWA"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"meh", ",", "Nmix2tmp"}], "}"}], " ", "=", 
     RowBox[{"calculateWideAngleExpansion2", "[", 
      RowBox[{"WARRexp", ",", "Newt"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"mixed", " ", "terms"}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{
     "so", " ", "get", " ", "mixed", " ", "terms", " ", "and", " ", "make", 
      " ", "sure", " ", "it", " ", "doesnt", " ", "have", " ", "other", " ", 
      "parts"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"temp", " ", "=", " ", 
     RowBox[{"Collect", "[", 
      RowBox[{"Nmix2tmp", ",", 
       RowBox[{"{", "c", "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "so", " ", "we", " ", "can", " ", "just", " ", "select", " ", "the", " ", 
      RowBox[{"c", "^", "1"}], " ", "parts"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{"NWARR", " ", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"temp", " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"temp", "/.", 
            RowBox[{"{", 
             RowBox[{"c", "->", "0"}], "}"}]}], ")"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "^", "2"}], "->", "0"}], "}"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"c", "->", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mixed", " ", 
     RowBox[{"GR", "/", "WS"}], " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NWAGR", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"calculateWideAngleExpansion1", "[", 
        RowBox[{"WAexp1", ",", "GR1"}], "]"}], "//.", "removeRR"}], "/.", 
      RowBox[{"{", 
       RowBox[{"H", "->", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NRRGR", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"calculateWideAngleExpansion1", "[", 
        RowBox[{"RRexp1", ",", "GR1"}], "]"}], "//.", "removeWA"}], "/.", 
      RowBox[{"{", 
       RowBox[{"H", "->", "1"}], "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.930226113776116*^9, 3.930226126782979*^9}, {
   3.930226361480689*^9, 3.930226361627592*^9}, {3.930226434962213*^9, 
   3.930226435976623*^9}, {3.930228095608057*^9, 3.930228095711628*^9}, {
   3.930228408271892*^9, 3.930228430379302*^9}, {3.930228479985661*^9, 
   3.9302284803523893`*^9}, {3.930229624262018*^9, 3.9302296656299267`*^9}, {
   3.930287118858811*^9, 3.9302871331623297`*^9}, {3.930287638177682*^9, 
   3.930287664973897*^9}, {3.930287718643929*^9, 3.930287884980009*^9}, {
   3.930287959457034*^9, 3.930287987041047*^9}, 3.9302888937668667`*^9, {
   3.930294444651964*^9, 3.930294456726674*^9}, {3.930295422453425*^9, 
   3.930295424307467*^9}, {3.930393233075902*^9, 3.9303932747487803`*^9}, {
   3.930393593894011*^9, 3.930393638356251*^9}, {3.930393797176394*^9, 
   3.930393798540071*^9}, {3.930393845992144*^9, 3.9303938475523853`*^9}, {
   3.9303938796367273`*^9, 3.9303938805492907`*^9}, 3.93610748741713*^9, {
   3.9447580603203907`*^9, 3.944758073246459*^9}, {3.944758107327382*^9, 
   3.944758107647126*^9}},ExpressionUUID->"bb82c449-77aa-4c22-a7fe-\
7f0c9f44d1dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"NWAGR", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "->", "0"}], ",", 
     RowBox[{"xb1", "->", "b1"}], ",", 
     RowBox[{"xgr1", "->", "gr1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.933958994167624*^9, 3.933958995782681*^9}, {
  3.933959180682312*^9, 3.933959229054821*^9}, {3.933959298169112*^9, 
  3.933959323076716*^9}, {3.936107477733995*^9, 3.936107478179294*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"99750b8f-551f-4e4d-b3d1-591b467d2d50"],

Cell[BoxData["NWAGR"], "Output",
 CellChangeTimes->{
  3.933958996177514*^9, {3.933959181200705*^9, 3.933959198709457*^9}, 
   3.933959229541296*^9, {3.9339592985664043`*^9, 3.9339593235394163`*^9}, 
   3.9361074820087147`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"2ae8fb8f-d7cb-4935-90ee-d9ce1c4ad42f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect each type after WS expansion", "Subsubsection",
 CellChangeTimes->{{3.936107515339876*^9, 
  3.93610752652064*^9}},ExpressionUUID->"2c8a8b05-d475-4d93-9512-\
dbd5e9114cef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<WA1\>\"", "]"}], " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], 
    RowBox[{"sortdotproducts1", "[", "NWA1", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<RR1\>\"", "]"}], " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], 
    RowBox[{"sortdotproducts1", "[", "NRR1", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<WAGR\>\"", "]"}], " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], 
    RowBox[{"sortdotproducts1", "[", "NWAGR", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<RRGR\>\"", "]"}], " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], 
    RowBox[{"sortdotproducts1", "[", "NRRGR", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<WA2\>\"", "]"}], " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "^", "2"}], 
    RowBox[{"sortdotproducts2", "[", "NWA2", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<RR2\>\"", "]"}], " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "^", "2"}], 
    RowBox[{"sortdotproducts2", "[", "NRR2", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<WARR\>\"", "]"}], " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "^", "2"}], 
    RowBox[{"sortdotproducts2", "[", "NWARR", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.930294186848858*^9, 3.930294215149281*^9}, {
  3.9302943009417677`*^9, 3.930294314472579*^9}, {3.930294345836363*^9, 
  3.930294398909028*^9}, {3.930294532262398*^9, 3.9302945346963778`*^9}, {
  3.9303938108076553`*^9, 3.930393855169368*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"9c545c4d-c797-450d-bacd-9905e53d7257"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"pkdict", "[", "\"\<WAGR\>\"", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"xb1", "->", "b1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.933956128147875*^9, 3.933956158931505*^9}, 
   3.933957209817851*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"86b28163-832b-41ff-9a70-56cb5ce4b327"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["D1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gr1", " ", "t"}], "+", "xgr1", "-", 
        RowBox[{"t", " ", "xgr1"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "Pk", " ", 
         SuperscriptBox["\[Eta]", "2"]}], "+", 
        RowBox[{"k1", " ", "Pkd", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[Eta]", "2"]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"f", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gr1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"3", " ", "t"}]}], ")"}]}], "+", "xgr1", "-", 
        RowBox[{"3", " ", "t", " ", "xgr1"}]}], ")"}], " ", 
      SuperscriptBox["\[Eta]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Pk", " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Eta]", "2"]}]}], ")"}]}], "+", 
        RowBox[{"k1", " ", "Pkd", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[Eta]", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"d", " ", 
   SuperscriptBox["k1", "2"]}]]], "Output",
 CellChangeTimes->{{3.933956138590495*^9, 3.9339561592443247`*^9}, 
   3.9339561960449457`*^9, 3.933957210636257*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"07900f78-529f-4bc7-8903-649fa59c454a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["Export multipoles ", "Section",
 CellChangeTimes->{{3.9361075701867437`*^9, 
  3.936107580336892*^9}},ExpressionUUID->"9efcd34a-6ae9-48c2-bd01-\
519bfcf8e002"],

Cell[CellGroupData[{

Cell["Export multipoles ", "Section",
 CellChangeTimes->{{3.9361075701867437`*^9, 
  3.936107580336892*^9}},ExpressionUUID->"346d4724-2285-4565-bb29-\
4328b24e5e51"],

Cell[CellGroupData[{

Cell[BoxData["dfog"], "Input",
 CellChangeTimes->{{3.945697940156426*^9, 3.945697944181711*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"a46501eb-098e-40be-adc7-27cb88d689a3"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   SuperscriptBox["\[Eta]", "2"], " ", 
   SuperscriptBox["\[Sigma]", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Norm", "[", "q1", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.945697941293461*^9, 3.945697944497048*^9}},
 CellLabel->"Out[79]=",ExpressionUUID->"46f87292-2374-4cfc-bc49-b4206e2d5ae4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", "=", " ", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "  ", "2"}], "+", "1"}], ")"}], "/", "2"}], " ", "dfog",
       " ", 
      RowBox[{"pkdict", "[", "key", "]"}], " ", 
      RowBox[{"LegendreP", "[", 
       RowBox[{"2", ",", "\[Eta]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Eta]", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "/.", 
   "cleantoexport"}]}]], "Input",
 CellChangeTimes->{{3.9456916569107227`*^9, 3.945691663972974*^9}, {
  3.9456929189821377`*^9, 3.945692928174445*^9}, {3.9456931381186*^9, 
  3.9456931431814013`*^9}, {3.945693260243031*^9, 3.9456932780228567`*^9}, {
  3.945693365566841*^9, 3.94569336879849*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"9b47c3f9-0003-422e-82d8-02a0aa926191"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SuperscriptBox["k1", "7"], " ", 
     SuperscriptBox["sigma", "7"]}]], 
   RowBox[{"5", " ", 
    SuperscriptBox["D1", "2"], " ", "Pk", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"90", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         SuperscriptBox["k1", "2"], " ", 
         SuperscriptBox["sigma", "2"]}]], " ", 
       SuperscriptBox["f", "2"], " ", "k1", " ", "sigma"}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         SuperscriptBox["k1", "2"], " ", 
         SuperscriptBox["sigma", "2"]}]], " ", "f", " ", 
       SuperscriptBox["k1", "3"], " ", 
       SuperscriptBox["sigma", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "b1"}], "+", 
         RowBox[{"4", " ", "f"}], "+", 
         RowBox[{"3", " ", "xb1"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         SuperscriptBox["k1", "2"], " ", 
         SuperscriptBox["sigma", "2"]}]], " ", 
       SuperscriptBox["k1", "5"], " ", 
       SuperscriptBox["sigma", "5"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "f", " ", 
          RowBox[{"(", 
           RowBox[{"f", "+", "xb1"}], ")"}]}], "+", 
         RowBox[{"b1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "f"}], "+", 
            RowBox[{"3", " ", "xb1"}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"45", " ", 
       SuperscriptBox["f", "2"], " ", 
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"k1", " ", "sigma"}], 
         SqrtBox["2"]], "]"}]}], "+", 
      RowBox[{"3", " ", "f", " ", 
       SuperscriptBox["k1", "2"], " ", 
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       SuperscriptBox["sigma", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "b1"}], "+", "f", "-", 
         RowBox[{"3", " ", "xb1"}]}], ")"}], " ", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"k1", " ", "sigma"}], 
         SqrtBox["2"]], "]"}]}], "+", 
      RowBox[{"b1", " ", 
       SuperscriptBox["k1", "6"], " ", 
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       SuperscriptBox["sigma", "6"], " ", "xb1", " ", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"k1", " ", "sigma"}], 
         SqrtBox["2"]], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["k1", "4"], " ", 
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       SuperscriptBox["sigma", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b1", " ", 
          RowBox[{"(", 
           RowBox[{"f", "-", 
            RowBox[{"3", " ", "xb1"}]}], ")"}]}], "+", 
         RowBox[{"f", " ", "xb1"}]}], ")"}], " ", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"k1", " ", "sigma"}], 
         SqrtBox["2"]], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.94569190788526*^9, 3.945692938600354*^9, 
  3.945693281072978*^9, 3.945693374829262*^9, 3.9456979955441647`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"894b1e05-0b61-46dd-a0a6-0d31e6c785f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"b", " ", "=", 
  RowBox[{"getpklm", "[", 
   RowBox[{"2", ",", "key", ",", "True"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9456931627096024`*^9, 3.945693187685608*^9}, {
  3.945693256868106*^9, 3.945693257485319*^9}, {3.94569337172025*^9, 
  3.945693371976323*^9}, {3.945698003916562*^9, 3.945698006406251*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"e6bee491-d0ef-408f-b1ce-e0f071b8dad1"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"5", " ", 
    SuperscriptBox["D1", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["sigma", "2"]}]], " ", "Pk", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "k1", " ", "sigma", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["f", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"45", "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k1", "4"], " ", 
             SuperscriptBox["sigma", "4"]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "b1", " ", 
          SuperscriptBox["k1", "4"], " ", 
          SuperscriptBox["sigma", "4"], " ", "xb1"}], "+", 
         RowBox[{"f", " ", 
          SuperscriptBox["k1", "2"], " ", 
          SuperscriptBox["sigma", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"9", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"b1", "+", "xb1"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          SuperscriptBox["k1", "2"], " ", 
          SuperscriptBox["sigma", "2"]}], "2"]], " ", 
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          SuperscriptBox["f", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "15"}], "+", 
            RowBox[{
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
         RowBox[{"b1", " ", 
          SuperscriptBox["k1", "4"], " ", 
          SuperscriptBox["sigma", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}], " ", "xb1"}], "+", 
         RowBox[{"f", " ", 
          SuperscriptBox["k1", "2"], " ", 
          SuperscriptBox["sigma", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "9"}], "+", 
            RowBox[{
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"b1", "+", "xb1"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"k1", " ", "sigma"}], 
         SqrtBox["2"]], "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["k1", "7"], " ", 
    SuperscriptBox["sigma", "7"]}]]}]], "Output",
 CellChangeTimes->{3.9456932020715933`*^9, 3.945693296774724*^9, 
  3.945693438209106*^9, 3.9456980432760983`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"f5fd926b-2a6e-46d8-b033-7e613d521750"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", "a", ")"}], "-", "b"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.945693265015976*^9, 3.945693356217782*^9}, 
   3.945698097981882*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"138ee72b-172d-4ffa-9c9d-f1e3bbfedc19"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9456933137591057`*^9, 3.945693356544158*^9}, 
   3.945693452323845*^9, {3.945698087437767*^9, 3.945698098971781*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"7356fbeb-ef3e-4aa1-8056-ddd4d0182c72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"key", " ", "=", " ", "\"\<GR0\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"getpklm", "[", 
  RowBox[{"0", ",", "key", ",", "True"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"getpklm", "[", 
  RowBox[{"2", ",", "key", ",", "True"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzH0s1AEcx/E7/SG6SXdoPVBupfQwTbnVsbO7VDId+YNjF+WhB9NRlHW5
U2l5Smrp1Eg3EeWs4/yBVZOH4e4kmuWhZJaHdFfL02y0+n2+f3z22vufj3ts
cliCDYvF8mMGZaUvO54EWsX8MAcTlKhGP0BNP6cXblUWD8CGLb7D8Kqi8GYZ
o8CbXwAr4uIfwM22w6TaWvkI2nvPaWCzeeMzeOfKIqnlnHMuZ4w3cl1goOCU
B0wpLiNHS9KE1P7RvlA+16WGt9TdmZBbtOTKOm4Vi/i52+HOshgvqBt8KoQR
lqZI+KPzYhSsHYmOg9LaWNL+X1IijFTOkb8WeWkw/HQpua893QDrWmbJtl13
2WxGQ5ujHQwacXeByzwPMsPzhRC2vw71hd/3K/3hjMxCatbFBsNL7Ovk7JGl
cCiJyZFB1nLXZ3jhmJmUjo+buPhxDTVDjuzsILztaiETBCLDRJBVHNurJZMm
9cmTjDVFlSlQcj5ECS1h/SqoL5TlwWpFEpklD3gM96hKSIdOdiWcjXSqojZe
boHB1XlkfWNdD3xb3UxOf+n+Cr0ka0bhn72pv2FE4jVyrEV3YIqxdf6eDwyt
TBTBd6bdYjgRYCuFOrfWUOjIO6qAhSdPkI2izgqo7DWRaR4HN0wzpkjCSGOm
mwgKV/PJMbVfOeS6fCQVnuZXcH7AvgYKbHL0UNuTT7YnzQ7BtSrNMOQ4fXo4
wzjeNKWBgoKhKjjRZiUb1+vqIUduIFXyhQYLo13fCnnjW366ldHHQ6WEWuc3
y8YEq3hpWxbbxJi7kr0Davvuk24tf6UwOfVMCBw+5PceZoifk9n1VT/NjIJV
NWSU42FeD6NcP0iqZcZ2uGlB2gH/AwW767Q=
  "],
 CellLabel->"In[63]:=",ExpressionUUID->"8be16caa-9da8-4aa9-8687-811e446495f8"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["D1", "2"], " ", "Pk", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox["k1", "2"], " ", 
        SuperscriptBox["sigma", "2"]}]], " ", "f", " ", "k1", " ", "sigma", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{
            SuperscriptBox["k1", "2"], " ", 
            SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["k1", "2"], " ", 
         SuperscriptBox["sigma", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"b1", "+", "xb1"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["f", "2"]}], "+", 
        RowBox[{"b1", " ", 
         SuperscriptBox["k1", "4"], " ", 
         SuperscriptBox["sigma", "4"], " ", "xb1"}], "+", 
        RowBox[{"f", " ", 
         SuperscriptBox["k1", "2"], " ", 
         SuperscriptBox["sigma", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"b1", "+", "xb1"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Erf", "[", 
       FractionBox[
        RowBox[{"k1", " ", "sigma"}], 
        SqrtBox["2"]], "]"}]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "5"], " ", 
   SuperscriptBox["sigma", "5"]}]]], "Output",
 CellChangeTimes->{3.945684506382145*^9, 3.945686829754306*^9, 
  3.945686891891739*^9, 3.945687211157363*^9, 3.945688632039612*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"a8b08f5c-9a37-42f3-9a08-9579c001d433"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SuperscriptBox["k1", "7"], " ", 
     SuperscriptBox["sigma", "7"]}]], 
   RowBox[{"5", " ", 
    SuperscriptBox["D1", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["sigma", "2"]}]], " ", "Pk", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "k1", " ", "sigma", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["f", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"45", "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k1", "4"], " ", 
             SuperscriptBox["sigma", "4"]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "b1", " ", 
          SuperscriptBox["k1", "4"], " ", 
          SuperscriptBox["sigma", "4"], " ", "xb1"}], "+", 
         RowBox[{"f", " ", 
          SuperscriptBox["k1", "2"], " ", 
          SuperscriptBox["sigma", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"9", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"b1", "+", "xb1"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          SuperscriptBox["k1", "2"], " ", 
          SuperscriptBox["sigma", "2"]}], "2"]], " ", 
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          SuperscriptBox["f", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "15"}], "+", 
            RowBox[{
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
         RowBox[{"b1", " ", 
          SuperscriptBox["k1", "4"], " ", 
          SuperscriptBox["sigma", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}], " ", "xb1"}], "+", 
         RowBox[{"f", " ", 
          SuperscriptBox["k1", "2"], " ", 
          SuperscriptBox["sigma", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "9"}], "+", 
            RowBox[{
             SuperscriptBox["k1", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"b1", "+", "xb1"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"k1", " ", "sigma"}], 
         SqrtBox["2"]], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.945684506382145*^9, 3.945686829754306*^9, 
  3.945686891891739*^9, 3.945687211157363*^9, 3.9456886693385477`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"d0d1771e-14aa-44e7-827a-fbea643198f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Old concolution stuff below", "Subtitle",
 CellChangeTimes->{{3.931581866030716*^9, 
  3.93158187890438*^9}},ExpressionUUID->"81f482f2-8a43-497f-876a-\
f7e652bad506"],

Cell["Convolution stuff below...", "Text",
 CellChangeTimes->{{3.904904600950742*^9, 
  3.904904609262887*^9}},ExpressionUUID->"3f3b1e71-d20e-4d4a-81ff-\
6d5256b8a780"],

Cell[BoxData[
 RowBox[{"convolutionrules", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kk", " ", "->", " ", "kk"}], ",", 
    RowBox[{"\[Eta]", "->", 
     RowBox[{
      RowBox[{"\[Nu]", "/", "kk"}], "+", " ", 
      RowBox[{"\[Eta]", " ", 
       RowBox[{"ks", "/", "kk"}]}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.930370216143388*^9, 3.930370238760991*^9}, 
   3.930370277099345*^9},ExpressionUUID->"025c6fd0-98a6-454e-9877-\
caddc6792a97"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forconvolution", " ", "=", 
  RowBox[{"Refine", "[", 
   RowBox[{"Totalpk", "  ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kk", " ", "->", " ", "kk"}], ",", 
      RowBox[{"\[Eta]", "->", 
       RowBox[{
        RowBox[{"\[Nu]", "/", "kk"}], "+", " ", 
        RowBox[{"\[Eta]", " ", 
         RowBox[{"ks", "/", "kk"}]}]}]}], ",", 
      RowBox[{"a", "->", "t"}], ",", 
      RowBox[{"c", "->", "0"}]}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"\[Sigma]", "^", "2"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kk", " ", "\[Eta]"}], " ", ")"}], "^", "2"}]}], ")"}]}], 
    "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.901179763726638*^9, 3.9011798837595387`*^9}, {
   3.901179929973551*^9, 3.901179991021501*^9}, {3.9011803465760183`*^9, 
   3.901180370863151*^9}, {3.901190297102027*^9, 3.9011903100846252`*^9}, {
   3.901190363783092*^9, 3.901190374717038*^9}, {3.9011909543253098`*^9, 
   3.901190968238989*^9}, {3.901288712236931*^9, 3.9012887736462317`*^9}, {
   3.901360968381589*^9, 3.901360969222183*^9}, 3.901607827399949*^9, {
   3.901607874907384*^9, 3.9016078823292933`*^9}, {3.901614719043109*^9, 
   3.901614722898597*^9}, {3.9019603758796597`*^9, 3.901960376287771*^9}, {
   3.9019604404496803`*^9, 3.901960440765567*^9}, {3.902468297747751*^9, 
   3.902468302189896*^9}, {3.902483751424708*^9, 3.9024837764491053`*^9}, 
   3.902483845227947*^9, 3.905868363065681*^9, {3.905869876101139*^9, 
   3.9058698781644163`*^9}, {3.9058701397886753`*^9, 3.905870154803275*^9}, 
   3.905870218398953*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"c66be94a-716f-43d6-83b1-1d7cfa29a199"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["Df", "2"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"b1", "+", 
     RowBox[{"f", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"ks", " ", "\[Eta]"}], "kk"], "+", 
         FractionBox["\[Nu]", "kk"]}], ")"}], "2"]}]}], ")"}], "2"], " ", 
  RowBox[{"P", "[", "kk", "]"}]}]], "Output",
 CellChangeTimes->{
  3.901607882659892*^9, 3.901614723421611*^9, 3.901792864414834*^9, 
   3.9017941262906857`*^9, 3.901952156486787*^9, 3.901958088463499*^9, 
   3.901960376807811*^9, 3.901960443547718*^9, 3.901961331293833*^9, {
   3.9024683026094923`*^9, 3.902468308036018*^9}, 3.902475950866351*^9, 
   3.9024759979332848`*^9, 3.902476979265332*^9, 3.902483752578747*^9, 
   3.902483801397183*^9, 3.902483864141271*^9, 3.905868350148325*^9, {
   3.905869870531239*^9, 3.905869879837379*^9}, 3.905870030025828*^9, 
   3.905870167204007*^9, 3.905870240424872*^9, 3.90587202227234*^9, 
   3.908206791974523*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"898cb9d4-e100-4381-8dd1-ce73a15325ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"muiltpole", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ExponentialE]", "->", " ", "e"}], ",", 
      RowBox[{"\[Sigma]", "->", "sigma"}], ",", 
      RowBox[{
       SqrtBox["\[Pi]"], "->", 
       RowBox[{
        RowBox[{"(", "pi", ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
      RowBox[{
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", "pi"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Erf", "[", 
      RowBox[{"kk", " ", "sigma"}], "]"}], "->", "erfunc"}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"ks", " ", "sigma"}], 
         SqrtBox["2"]], "]"}], "->", " ", "erfunc2"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"Erf", "[", " ", 
      RowBox[{"ks", " ", "\[Sigma]"}], "]"}], "->", "erfunc"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.890716017718863*^9, 3.8907160383486223`*^9}, {
   3.8907161759960947`*^9, 3.890716176414855*^9}, {3.8907168827911263`*^9, 
   3.890716926905993*^9}, {3.890718199471929*^9, 3.890718221457458*^9}, 
   3.8907182648178787`*^9, {3.8907347749746017`*^9, 3.8907347793521338`*^9}, {
   3.890734820630287*^9, 3.890734865343251*^9}, {3.89073490392701*^9, 
   3.890734925776347*^9}, {3.8907350052029676`*^9, 3.890735049881138*^9}, {
   3.8907353126730013`*^9, 3.890735342756447*^9}, {3.890736067503605*^9, 
   3.8907360760542583`*^9}, {3.8907362251860657`*^9, 3.8907362338508587`*^9}, 
   3.890739069427286*^9, {3.899790633232738*^9, 3.899790633547385*^9}, 
   3.899792020064136*^9, {3.899797204346765*^9, 3.899797213633256*^9}, {
   3.8997973000636253`*^9, 3.899797303355654*^9}, 3.901952575257965*^9},
 CellLabel->
  "In[214]:=",ExpressionUUID->"757c8ce7-a708-4f73-847d-08d7fc114c7d"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", "d", " ", 
     SuperscriptBox["kk", "15"], " ", 
     SuperscriptBox["sigma", "9"]}]], 
   RowBox[{"7", " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["e", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["kk", "2"]}], " ", 
      SuperscriptBox["sigma", "2"]}]], " ", "f", " ", "ks", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kk", " ", "Pkd", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", "b1", " ", 
          SuperscriptBox["kk", "7"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["kk", "2"], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
          SuperscriptBox["sigma", "5"], " ", 
          RowBox[{"(", 
           RowBox[{"15", "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["kk", "2"], " ", 
             SuperscriptBox["sigma", "2"]}]}], ")"}]}], "-", 
         RowBox[{"4", " ", "b1", " ", 
          SuperscriptBox["kk", "5"], " ", 
          SuperscriptBox["ks", "2"], " ", 
          SuperscriptBox["sigma", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"75", "+", 
            RowBox[{"32", " ", 
             SuperscriptBox["kk", "2"], " ", 
             SuperscriptBox["sigma", "2"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["kk", "4"], " ", 
             SuperscriptBox["sigma", "4"]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["e", 
           RowBox[{
            SuperscriptBox["kk", "2"], " ", 
            SuperscriptBox["sigma", "2"]}]], " ", "erfunc", " ", 
          SqrtBox["pi"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "b1", " ", 
             SuperscriptBox["kk", "4"], " ", 
             SuperscriptBox["ks", "2"], " ", 
             SuperscriptBox["sigma", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"25", "-", 
               RowBox[{"6", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
            RowBox[{"4", " ", "f", " ", 
             SuperscriptBox["kk", "4"], " ", 
             SuperscriptBox["nu", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["kk", "2"]}], "-", 
               RowBox[{"5", " ", 
                SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
             SuperscriptBox["sigma", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "5"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
            RowBox[{"4", " ", "b1", " ", 
             SuperscriptBox["kk", "6"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["kk", "2"], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
             SuperscriptBox["sigma", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "5"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "-", 
            RowBox[{"5", " ", "f", " ", 
             SuperscriptBox["ks", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "35"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "f", " ", 
             SuperscriptBox["kk", "2"], " ", 
             SuperscriptBox["ks", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["kk", "2"], "-", 
               RowBox[{"10", " ", 
                SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
             SuperscriptBox["sigma", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "25"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "525"}], " ", "kk", " ", 
             SuperscriptBox["ks", "4"], " ", "sigma"}], "-", 
            RowBox[{"20", " ", 
             SuperscriptBox["kk", "3"], " ", 
             SuperscriptBox["ks", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"13", " ", 
                SuperscriptBox["ks", "2"]}], "+", 
               RowBox[{"75", " ", 
                SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
             SuperscriptBox["sigma", "3"]}], "+", 
            RowBox[{"16", " ", 
             SuperscriptBox["kk", "9"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["ks", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
             SuperscriptBox["sigma", "7"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["kk", "7"], " ", 
             SuperscriptBox["sigma", "5"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["ks", "4"], " ", 
                SuperscriptBox["sigma", "2"]}], "+", 
               RowBox[{"5", " ", 
                SuperscriptBox["nu", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "9"}], "+", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["nu", "2"], " ", 
                   SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
               RowBox[{"8", " ", 
                SuperscriptBox["ks", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", 
                  RowBox[{"5", " ", 
                   SuperscriptBox["nu", "2"], " ", 
                   SuperscriptBox["sigma", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
            
            RowBox[{"10", " ", 
             SuperscriptBox["kk", "5"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"8", " ", 
                SuperscriptBox["ks", "4"], " ", 
                SuperscriptBox["sigma", "5"]}], "+", 
               RowBox[{"30", " ", 
                SuperscriptBox["nu", "4"], " ", 
                SuperscriptBox["sigma", "5"]}], "+", 
               RowBox[{
                SuperscriptBox["ks", "2"], " ", 
                SuperscriptBox["sigma", "3"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "15"}], "+", 
                  RowBox[{"64", " ", 
                   SuperscriptBox["nu", "2"], " ", 
                   SuperscriptBox["sigma", "2"]}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], "-", 
      RowBox[{"4", " ", "Pks", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          SuperscriptBox["e", 
           RowBox[{
            SuperscriptBox["kk", "2"], " ", 
            SuperscriptBox["sigma", "2"]}]], " ", "erfunc", " ", 
          SqrtBox["pi"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b1", " ", 
             SuperscriptBox["kk", "4"], " ", 
             SuperscriptBox["ks", "2"], " ", 
             SuperscriptBox["sigma", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"25", "-", 
               RowBox[{"6", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
            RowBox[{"6", " ", "b1", " ", 
             SuperscriptBox["kk", "6"], " ", 
             SuperscriptBox["nu", "2"], " ", 
             SuperscriptBox["sigma", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"5", "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "f", " ", 
             SuperscriptBox["kk", "4"], " ", 
             SuperscriptBox["nu", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["kk", "2"]}], "-", 
               RowBox[{"10", " ", 
                SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
             SuperscriptBox["sigma", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "5"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "-", 
            RowBox[{"5", " ", "f", " ", 
             SuperscriptBox["ks", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "35"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
            RowBox[{"f", " ", 
             SuperscriptBox["kk", "2"], " ", 
             SuperscriptBox["ks", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["kk", "2"], "-", 
               RowBox[{"20", " ", 
                SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
             SuperscriptBox["sigma", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "25"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["sigma", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b1", " ", 
             SuperscriptBox["kk", "5"], " ", 
             SuperscriptBox["sigma", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"6", " ", 
                SuperscriptBox["kk", "2"], " ", 
                SuperscriptBox["nu", "2"], " ", 
                SuperscriptBox["sigma", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"15", "+", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["kk", "2"], " ", 
                   SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["ks", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"75", "+", 
                  RowBox[{"32", " ", 
                   SuperscriptBox["kk", "2"], " ", 
                   SuperscriptBox["sigma", "2"]}], "+", 
                  RowBox[{"8", " ", 
                   SuperscriptBox["kk", "4"], " ", 
                   SuperscriptBox["sigma", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
            
            RowBox[{"f", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"525", " ", "kk", " ", 
                SuperscriptBox["ks", "4"], " ", "sigma"}], "+", 
               RowBox[{"20", " ", 
                SuperscriptBox["kk", "3"], " ", 
                SuperscriptBox["ks", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"13", " ", 
                   SuperscriptBox["ks", "2"]}], "+", 
                  RowBox[{"75", " ", 
                   SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
                SuperscriptBox["sigma", "3"]}], "-", 
               RowBox[{"8", " ", 
                SuperscriptBox["kk", "9"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["ks", "2"], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["nu", "2"]}]}], ")"}], " ", 
                SuperscriptBox["sigma", "7"]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["kk", "7"], " ", 
                SuperscriptBox["sigma", "5"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"8", " ", 
                   SuperscriptBox["ks", "4"], " ", 
                   SuperscriptBox["sigma", "2"]}], "+", 
                  RowBox[{"16", " ", 
                   SuperscriptBox["ks", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["nu", "2"], " ", 
                    SuperscriptBox["sigma", "2"]}]}], ")"}]}], "+", 
                  RowBox[{"5", " ", 
                   SuperscriptBox["nu", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "9"}], "+", 
                    RowBox[{"8", " ", 
                    SuperscriptBox["nu", "2"], " ", 
                    SuperscriptBox["sigma", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"5", " ", 
                SuperscriptBox["kk", "5"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"16", " ", 
                   SuperscriptBox["ks", "4"], " ", 
                   SuperscriptBox["sigma", "5"]}], "+", 
                  RowBox[{"60", " ", 
                   SuperscriptBox["nu", "4"], " ", 
                   SuperscriptBox["sigma", "5"]}], "+", 
                  RowBox[{
                   SuperscriptBox["ks", "2"], " ", 
                   SuperscriptBox["sigma", "3"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "15"}], "+", 
                    RowBox[{"128", " ", 
                    SuperscriptBox["nu", "2"], " ", 
                    SuperscriptBox["sigma", "2"]}]}], ")"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "t"}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.890735331710518*^9, 3.890735343585631*^9}, 
   3.890736077109056*^9, 3.89073623466437*^9, 3.890739070152586*^9, 
   3.890739466524411*^9, 3.890740546455963*^9, 3.8907407878002243`*^9, 
   3.8907456337824078`*^9, 3.8907458772701197`*^9, 3.89074703779757*^9, 
   3.8907505944007874`*^9, 3.890798137728471*^9, 3.890798175883112*^9, 
   3.890798674683592*^9, 3.899788492014694*^9, 3.8997889480982513`*^9, 
   3.8997905433538523`*^9, 3.899791352373362*^9, 3.899794119995747*^9, 
   3.899795456356394*^9, 3.899796352881975*^9, 3.8997970361578827`*^9, 
   3.899797213985469*^9, 3.8997973076250143`*^9, 3.899797914087452*^9, 
   3.899801508158124*^9, 3.899801911215267*^9, 3.900504319945472*^9, 
   3.9024841480482197`*^9, 3.905871222023437*^9},
 CellLabel->
  "Out[214]=",ExpressionUUID->"b9fa86cf-80a9-42d7-a541-6343c523d121"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{906, 552},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.7 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"03850d0b-94b2-4bd8-9634-6486b232b960"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 99, 1, 3, "PageBreak",ExpressionUUID->"c5330af3-aca8-4af7-9a6c-9cd2240f3d59",
 PageBreakBelow->True],
Cell[660, 23, 323, 5, 21, "Input",ExpressionUUID->"700ee33e-1921-483b-af19-a8175b0c8fb4"],
Cell[CellGroupData[{
Cell[1008, 32, 230, 4, 68, "Title",ExpressionUUID->"0b657c16-37b0-46a4-b101-bb63b9662db7"],
Cell[CellGroupData[{
Cell[1263, 40, 166, 3, 32, "Subsubsection",ExpressionUUID->"8f359d76-3d46-4abe-b7a1-ad8a63f189d2"],
Cell[1432, 45, 1615, 38, 94, "Input",ExpressionUUID->"298a57c3-5d10-48c1-aa6d-d410276c0b29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3084, 88, 205, 3, 32, "Subsubsection",ExpressionUUID->"fdb0acc9-8265-4e87-bd42-891d24a960cb"],
Cell[3292, 93, 3129, 74, 94, "Input",ExpressionUUID->"2acbd79d-c899-4c6a-89b5-bc72f33f434f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6458, 172, 171, 3, 38, "Subsection",ExpressionUUID->"d80ad59b-d1f5-484b-8912-9bb52d347a48"],
Cell[6632, 177, 1616, 42, 82, "Input",ExpressionUUID->"fb447f38-01e9-480b-9f79-bd172508dbff"],
Cell[8251, 221, 370, 9, 36, "Input",ExpressionUUID->"a4c893a7-1772-4283-9b94-5e1db6df5e4f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8658, 235, 267, 6, 38, "Subsection",ExpressionUUID->"b4b5587b-b51f-45f6-9cc2-4e18187ecd14"],
Cell[8928, 243, 1220, 34, 50, "Input",ExpressionUUID->"896cf271-a142-4e86-b230-be03dbcb7827"],
Cell[10151, 279, 3090, 79, 141, "Input",ExpressionUUID->"499e6a4f-d58a-4323-a43b-0426f930551f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13278, 363, 184, 3, 47, "Section",ExpressionUUID->"0956e5e8-3062-4b1b-8dca-75b6df743a45"],
Cell[13465, 368, 2106, 59, 65, "Input",ExpressionUUID->"2cc9f09d-a8e7-44dc-9894-d6158dfad971"],
Cell[15574, 429, 1112, 31, 67, "Input",ExpressionUUID->"77e7e36d-76bc-47eb-984a-18480be0e7a2"],
Cell[16689, 462, 1381, 37, 50, "Input",ExpressionUUID->"ab082b71-cf3f-4d85-8fbe-c4261db27bc0"],
Cell[CellGroupData[{
Cell[18095, 503, 811, 13, 36, "Input",ExpressionUUID->"ec9366ec-e232-410d-a0d8-f763bf2b602c"],
Cell[18909, 518, 2635, 70, 42, "Output",ExpressionUUID->"2551bed9-af33-449a-a90d-305932033081"],
Cell[21547, 590, 636, 12, 38, "Output",ExpressionUUID->"7c318686-5be9-43a2-a20b-3def94b06b90"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[22232, 608, 164, 3, 39, "Section",ExpressionUUID->"e5c1fb14-54ed-4da4-9e48-7584dfa87480"],
Cell[CellGroupData[{
Cell[22421, 615, 3024, 75, 82, "Input",ExpressionUUID->"6c0cf25f-b0fb-4fe0-80f3-3a7a60a99cdf"],
Cell[25448, 692, 1616, 39, 66, "Output",ExpressionUUID->"ec5c545a-38c9-49d5-a80f-957babec0d0b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27113, 737, 167, 3, 47, "Section",ExpressionUUID->"caf437df-1003-4b33-9e9a-0f6c32a2cb17"],
Cell[27283, 742, 3862, 92, 137, "Input",ExpressionUUID->"bb82c449-77aa-4c22-a7fe-7f0c9f44d1dc"],
Cell[CellGroupData[{
Cell[31170, 838, 525, 11, 21, "Input",ExpressionUUID->"99750b8f-551f-4e4d-b3d1-591b467d2d50"],
Cell[31698, 851, 305, 5, 23, "Output",ExpressionUUID->"2ae8fb8f-d7cb-4935-90ee-d9ce1c4ad42f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32040, 861, 186, 3, 32, "Subsubsection",ExpressionUUID->"2c8a8b05-d475-4d93-9512-dbd5e9114cef"],
Cell[32229, 866, 2179, 63, 118, "Input",ExpressionUUID->"9c545c4d-c797-450d-bacd-9905e53d7257"],
Cell[CellGroupData[{
Cell[34433, 933, 354, 8, 21, "Input",ExpressionUUID->"86b28163-832b-41ff-9a70-56cb5ce4b327"],
Cell[34790, 943, 1609, 47, 39, "Output",ExpressionUUID->"07900f78-529f-4bc7-8903-649fa59c454a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[36438, 995, 165, 3, 47, "Section",ExpressionUUID->"9efcd34a-6ae9-48c2-bd01-519bfcf8e002"],
Cell[CellGroupData[{
Cell[36628, 1002, 165, 3, 39, "Section",ExpressionUUID->"346d4724-2285-4565-bb29-4328b24e5e51"],
Cell[CellGroupData[{
Cell[36818, 1009, 175, 2, 21, "Input",ExpressionUUID->"a46501eb-098e-40be-adc7-27cb88d689a3"],
Cell[36996, 1013, 416, 10, 29, "Output",ExpressionUUID->"46f87292-2374-4cfc-bc49-b4206e2d5ae4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37449, 1028, 873, 22, 21, "Input",ExpressionUUID->"9b47c3f9-0003-422e-82d8-02a0aa926191"],
Cell[38325, 1052, 3508, 101, 73, "Output",ExpressionUUID->"894b1e05-0b61-46dd-a0a6-0d31e6c785f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41870, 1158, 417, 7, 21, "Input",ExpressionUUID->"e6bee491-d0ef-408f-b1ce-e0f071b8dad1"],
Cell[42290, 1167, 3115, 86, 59, "Output",ExpressionUUID->"f5fd926b-2a6e-46d8-b033-7e613d521750"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45442, 1258, 299, 7, 21, "Input",ExpressionUUID->"138ee72b-172d-4ffa-9c9d-f1e3bbfedc19"],
Cell[45744, 1267, 247, 3, 50, "Output",ExpressionUUID->"7356fbeb-ef3e-4aa1-8056-ddd4d0182c72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46028, 1275, 1342, 26, 65, "Input",ExpressionUUID->"8be16caa-9da8-4aa9-8687-811e446495f8"],
Cell[47373, 1303, 1794, 52, 51, "Output",ExpressionUUID->"a8b08f5c-9a37-42f3-9a08-9579c001d433"],
Cell[49170, 1357, 3157, 87, 74, "Output",ExpressionUUID->"d0d1771e-14aa-44e7-827a-fbea643198f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52376, 1450, 172, 3, 37, "Subtitle",ExpressionUUID->"81f482f2-8a43-497f-876a-f7e652bad506"],
Cell[52551, 1455, 168, 3, 24, "Text",ExpressionUUID->"3f3b1e71-d20e-4d4a-81ff-6d5256b8a780"],
Cell[52722, 1460, 459, 12, 22, "Input",ExpressionUUID->"025c6fd0-98a6-454e-9877-caddc6792a97"],
Cell[CellGroupData[{
Cell[53206, 1476, 1745, 37, 22, "Input",ExpressionUUID->"c66be94a-716f-43d6-83b1-1d7cfa29a199"],
Cell[54954, 1515, 1091, 24, 39, "Output",ExpressionUUID->"898cb9d4-e100-4381-8dd1-ce73a15325ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56082, 1544, 2048, 51, 43, "Input",ExpressionUUID->"757c8ce7-a708-4f73-847d-08d7fc114c7d"],
Cell[58133, 1597, 14846, 361, 131, "Output",ExpressionUUID->"b9fa86cf-80a9-42d7-a541-6343c523d121"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

