(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    121921,       3035]
NotebookOptionsPosition[    110432,       2843]
NotebookOutlinePosition[    110854,       2860]
CellTagsIndexPosition[    110811,       2857]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Computing relativistic  and wide-separation   bispectrum", "Title",
 CellChangeTimes->{
  3.9091337962358923`*^9, {3.9091338332868853`*^9, 3.909133858735435*^9}, {
   3.90913389336003*^9, 3.909133899000203*^9}, {3.909133962321252*^9, 
   3.909133967169168*^9}, {3.909134987396056*^9, 3.909135020871996*^9}, 
   3.909556126400786*^9, {3.910850952651021*^9, 3.910850970431525*^9}, 
   3.915866315693554*^9, {3.927541036469708*^9, 3.927541046705557*^9}, {
   3.928381777039616*^9, 3.928381777219575*^9}, {3.939966293753263*^9, 
   3.939966295457076*^9}},ExpressionUUID->"a6c2099a-8a82-468e-bcc6-\
ad0bbd958e12"],

Cell[BoxData[
 RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{3.910099530487406*^9},
 CellLabel->
  "In[318]:=",ExpressionUUID->"3bb6163f-4100-43ab-ad4a-b69079ba0a43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Load", " ", "in", " ", "expressions", " ", "to", " ", "calculate", " ", 
     "and", " ", "simplify", " ", "the", " ", "wide"}], "-", 
    RowBox[{"angle", " ", "expansion"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/Bk_funcsandrules.nb\>\"", 
      ",", 
      RowBox[{"EvaluationElements", "->", "\"\<InitializationCell\>\""}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"load", " ", "WA", " ", "and", " ", "RR", " ", "expansions"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/Expansions.nb\>\"", ",", 
      RowBox[{"EvaluationElements", "->", "\"\<InitializationCell\>\""}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"load", " ", "kernels"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/kernels.nb\>\"", ",", 
      RowBox[{"EvaluationElements", "->", "\"\<InitializationCell\>\""}]}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9091356187685947`*^9, 3.9091356399238367`*^9}, {
   3.909135907718828*^9, 3.90913592265914*^9}, {3.910083096762539*^9, 
   3.910083102394081*^9}, {3.915782841553748*^9, 3.9157828484053297`*^9}, {
   3.920187010250901*^9, 3.9201870106296597`*^9}, {3.925193770986248*^9, 
   3.925193780985744*^9}, {3.925273918718202*^9, 3.925273919332033*^9}, {
   3.92527409137495*^9, 3.925274115664418*^9}, {3.927652478657846*^9, 
   3.9276525142338543`*^9}, {3.9278163257307367`*^9, 
   3.9278163272019367`*^9}, {3.927867523451627*^9, 3.9278675605191603`*^9}, {
   3.927879969560309*^9, 3.9278799759065723`*^9}, 3.9283817850890303`*^9, {
   3.92885198805727*^9, 3.928851991530719*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"dcda73b0-e268-45e6-bd7c-0b1b8cfaa47a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"define", " ", "empty", " ", "dict"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"bkdict", "=", 
    RowBox[{"Association", "[", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{3.92787997838396*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"1c87efe0-a8b8-4f61-91be-bb2ac32b61f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Integrate", " ", "local", " ", "bispectrum", " ", "to", " ", "get", " ", 
    "spherical", " ", "harmonic", " ", "multipole", " ", "then", " ", "helps",
     " ", "mathematica", " ", "simplify", " ", "and", " ", "exports", " ", 
    "to", " ", 
    RowBox[{"a", " ", ".", "json"}], " ", 
    RowBox[{"file", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getbklm", "[", 
    RowBox[{"l_", ",", "m_", ",", "key_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bktmp", " ", "=", 
       RowBox[{"preparesimplists2", "[", 
        RowBox[{
         RowBox[{"bkdict", "[", "key", "]"}], ",", "l", ",", "m"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"simplifiedlist", " ", "=", 
       RowBox[{"Timing", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"Simplify", ",", " ", "bktmp"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Simplifcation time=\>\"", ",", 
        RowBox[{"simplifiedlist", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"bktmplist", " ", "=", 
       RowBox[{"simplifiedlist", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\</home/chris/Documents/Wolfram Mathematica/\>\"", ",", "key", 
          ",", "\"\<_l\>\"", ",", 
          RowBox[{"ToString", "[", "l", "]"}], ",", "\"\<m\>\"", ",", 
          RowBox[{"ToString", "[", "m", "]"}], ",", "\"\<.json\>\""}], "]"}], 
        ",", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Plus", " ", "@@", "bktmplist"}], ",", "InputForm"}], "]"}],
         ",", "\"\<JSON\>\""}], "]"}], ";"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.939945169082671*^9, 3.939945224188923*^9}, 
   3.93994725732495*^9, {3.939966421761222*^9, 3.939966427696189*^9}, {
   3.9399689887233963`*^9, 3.9399689954872217`*^9}, 3.939969124646137*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"9b6b5457-a0c0-4c33-bffb-1bf5f6e86e7e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "So", " ", "we", " ", "can", " ", "compute", " ", "a", " ", "permutation", 
    " ", "of", " ", "the", " ", "bispectrum", " ", "from", " ", "the", " ", 
    "fourier", " ", "kernels"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"K1", "[", 
     RowBox[{"q1_", ",", "x1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"KN1", "[", 
      RowBox[{"q1", ",", "x1"}], "]"}], "+", 
     RowBox[{"KGR1", "[", 
      RowBox[{"q1", ",", "x1"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K2", "[", 
     RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "x1_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"KN2", "[", 
      RowBox[{"q1", ",", "q2", ",", "x1"}], "]"}], "+", 
     RowBox[{
      RowBox[{"KGR2", "[", 
       RowBox[{"q1", ",", "q2", ",", "q3", ",", "x1"}], "]"}], "/", "2"}]}]}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bkperm", "[", 
     RowBox[{
     "q1_", ",", "q2_", ",", "q3_", ",", "x1_", ",", "x2_", ",", "x3_"}], 
     "]"}], " ", ":=", 
    RowBox[{"2", " ", 
     RowBox[{"K1", "[", 
      RowBox[{"q1", ",", "x1"}], "]"}], 
     RowBox[{"K1", "[", 
      RowBox[{"q2", ",", "x2"}], "]"}], 
     RowBox[{"K2", "[", 
      RowBox[{"q1", ",", "q2", ",", "q3", ",", "x3"}], "]"}], 
     RowBox[{"P", "[", 
      RowBox[{"Norm", "[", "q1", "]"}], "]"}], 
     RowBox[{"P", "[", 
      RowBox[{"Norm", "[", "q2", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939964347428981*^9, 3.939964388920649*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"1495b172-a487-4abd-b2da-d7993145818c"],

Cell[CellGroupData[{

Cell["\<\
Plane-parallel constant redshift terms to the bispectrum (Newtonian and \
relativistic)\
\>", "Section",
 CellChangeTimes->{{3.909136088270834*^9, 3.909136101817918*^9}, {
   3.909136385128017*^9, 3.909136386251898*^9}, {3.920187039201338*^9, 
   3.920187066426511*^9}, {3.939964438005611*^9, 3.9399644699532022`*^9}, {
   3.939965051724517*^9, 3.939965072608426*^9}, 
   3.9399657622300997`*^9},ExpressionUUID->"c0e6cbef-970c-4837-831d-\
051d15eb6ea6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"get", " ", "total", " ", "local", " ", "bispectrum"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BkFull", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Bkperm", "[", 
         RowBox[{
         "q1", ",", "q2", ",", "q3", ",", "x1", ",", "x2", ",", "x3"}], "]"}],
         "+", 
        RowBox[{"Bkperm", "[", 
         RowBox[{
         "q1", ",", "q3", ",", "q2", ",", "x1", ",", "x3", ",", "x2"}], "]"}],
         "+", 
        RowBox[{"Bkperm", "[", 
         RowBox[{
         "q2", ",", "q3", ",", "q1", ",", "x2", ",", "x3", ",", "x1"}], 
         "]"}]}], ")"}], "/.", "simpletensorexpand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"split", " ", "in", " ", "orders", " ", "of", " ", 
      RowBox[{"(", 
       RowBox[{"H", "/", "k"}], ")"}]}], " ", "-", " ", 
     RowBox[{
     "H", " ", "here", " ", "is", " ", "a", " ", "dummy", " ", "index", " ", 
      "for", " ", "GR", " ", "order", " ", 
      RowBox[{"(", 
       RowBox[{"great", " ", "notation", " ", "i", " ", "know"}], ")"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bkorders", "=", " ", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{"BkFull", ",", 
        RowBox[{"{", 
         RowBox[{"H", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR0Full", " ", "=", " ", 
     RowBox[{"Bkorders", " ", "/.", 
      RowBox[{"{", 
       RowBox[{"H", "->", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR1Full", " ", "=", " ", 
     RowBox[{
      RowBox[{"Bkorders", " ", "-", "GR0Full"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"H", "^", "2"}], "->", "0"}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"(", 
      RowBox[{"H", "/", "k"}], ")"}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR2Full", " ", "=", " ", 
     RowBox[{
     "Bkorders", " ", "-", " ", "GR0Full", " ", "-", " ", "GR1Full"}]}], " ", 
    
    RowBox[{"(*", 
     RowBox[{"check", " ", 
      RowBox[{"it", "'"}], "s", " ", 
      RowBox[{"H", "^", "2"}]}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H", "/", "k"}], ")"}], "^", "2"}], "*)"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.9094170833007298`*^9, 3.909417105432741*^9}, {
   3.9094184203101177`*^9, 3.9094185357913313`*^9}, {3.909419228285984*^9, 
   3.90941925568003*^9}, 3.9094200159409018`*^9, {3.909420117256136*^9, 
   3.909420125535866*^9}, {3.909464998116271*^9, 3.909464998356303*^9}, {
   3.909639386814052*^9, 3.9096393939449177`*^9}, {3.909639444770977*^9, 
   3.909639478860847*^9}, {3.9096395339582043`*^9, 3.909639535233972*^9}, {
   3.90963959612294*^9, 3.9096395996864433`*^9}, 3.909639999517682*^9, {
   3.909640586129833*^9, 3.909640639447112*^9}, {3.9096406740872993`*^9, 
   3.909640730800775*^9}, {3.91034747452922*^9, 3.910347476052498*^9}, {
   3.911036706843408*^9, 3.911036707525861*^9}, {3.91137147065445*^9, 
   3.911371472129889*^9}, 3.914928807011952*^9, 3.9149291438238907`*^9, {
   3.9149315454386883`*^9, 3.914931549670281*^9}, {3.914931798523899*^9, 
   3.9149318048443413`*^9}, {3.9149982616623096`*^9, 3.914998262312326*^9}, {
   3.9155345231755257`*^9, 3.915534528506665*^9}, {3.9155987874090233`*^9, 
   3.915598791415592*^9}, {3.9156157031438828`*^9, 3.915615719598481*^9}, {
   3.915618102199946*^9, 3.915618109657638*^9}, {3.9156185434639874`*^9, 
   3.915618581668509*^9}, {3.915618835026145*^9, 3.9156188422964478`*^9}, {
   3.9156901276961527`*^9, 3.915690137503312*^9}, {3.915690215341045*^9, 
   3.915690265764628*^9}, {3.915692389660759*^9, 3.915692406421205*^9}, {
   3.9156927619416018`*^9, 3.915692786568652*^9}, {3.9157264057611427`*^9, 
   3.9157264113076077`*^9}, {3.915783083294026*^9, 3.915783130614105*^9}, {
   3.915783182235611*^9, 3.915783207075047*^9}, {3.915784088480904*^9, 
   3.915784103478861*^9}, {3.916246136272359*^9, 3.9162461393951693`*^9}, {
   3.917362225540077*^9, 3.917362313477598*^9}, {3.917362563291802*^9, 
   3.917362563459935*^9}, {3.917452111044598*^9, 3.917452111165299*^9}, {
   3.917454008734383*^9, 3.9174540088197603`*^9}, {3.917494246057983*^9, 
   3.9174942462015257`*^9}, {3.91750146659172*^9, 3.91750146671488*^9}, {
   3.917501595094442*^9, 3.917501596297954*^9}, {3.918003658479762*^9, 
   3.918003664199538*^9}, {3.918003699396512*^9, 3.918003707102466*^9}, {
   3.918003769234252*^9, 3.918003771503681*^9}, {3.9180077855740643`*^9, 
   3.918007785732065*^9}, {3.918009550168201*^9, 3.91800955033007*^9}, {
   3.91818663099851*^9, 3.918186631075211*^9}, {3.918187625095029*^9, 
   3.918187625220316*^9}, 3.918200927148623*^9, {3.918200958828418*^9, 
   3.918200958935726*^9}, {3.918201166602421*^9, 3.918201166725164*^9}, {
   3.9182018468641253`*^9, 3.91820184697795*^9}, {3.918201989971307*^9, 
   3.91820199065473*^9}, {3.918281034110097*^9, 3.9182810341987143`*^9}, {
   3.9182815876815166`*^9, 3.9182815877353077`*^9}, {3.918282628871586*^9, 
   3.9182826299992733`*^9}, {3.918612045869362*^9, 3.918612046016179*^9}, {
   3.918612208263136*^9, 3.918612208382105*^9}, {3.9186168812080803`*^9, 
   3.918616883067487*^9}, {3.918618958264236*^9, 3.9186189584555817`*^9}, {
   3.918622898854988*^9, 3.918622898949266*^9}, {3.9186238894133797`*^9, 
   3.918623891444392*^9}, {3.920187100802496*^9, 3.920187113610983*^9}, {
   3.922331873128693*^9, 3.92233187380721*^9}, {3.92492353525311*^9, 
   3.924923537966846*^9}, {3.931506732461429*^9, 3.9315067353097143`*^9}, 
   3.9398784312403927`*^9, {3.939963282298604*^9, 3.939963318895523*^9}, {
   3.9399638283752003`*^9, 3.939963855808022*^9}, {3.939964152167799*^9, 
   3.939964233030261*^9}, {3.939964819969224*^9, 3.939964873553988*^9}, {
   3.9399649230663843`*^9, 3.939964968951551*^9}, {3.939965011053259*^9, 
   3.939965011792828*^9}, {3.93996630824979*^9, 3.9399663586821957`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"99e7f500-ed4e-4efd-8554-db7be3d27208"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "clean", " ", "terms", " ", "to", " ", "correct", " ", "format", " ", 
    "and", " ", "save", " ", "to", " ", "in", " ", "an", " ", "association"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bkdict", "[", "\"\<GR0\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GR0Full", "/.", 
         RowBox[{"{", 
          RowBox[{"H", "->", "1"}], "}"}]}], "/.", "removederiv"}], "/.", 
       "removewa"}], "/.", "cleantoexport"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"bkdict", "[", "\"\<GR1\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GR1Full", "/.", 
         RowBox[{"{", 
          RowBox[{"H", "->", "1"}], "}"}]}], "/.", "removederiv"}], "/.", 
       "removewa"}], "/.", "cleantoexport"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"bkdict", "[", "\"\<GR2\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GR2Full", "/.", 
         RowBox[{"{", 
          RowBox[{"H", "->", "1"}], "}"}]}], "/.", "removederiv"}], "/.", 
       "removewa"}], "/.", "cleantoexport"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.931499626459586*^9, {3.939964956215979*^9, 3.939965007812255*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"bd074f12-c520-49a4-888c-a02fb3916a6e"],

Cell[CellGroupData[{

Cell["Export terms!", "Subsubsection",
 CellChangeTimes->{{3.939965152954879*^9, 
  3.939965162318399*^9}},ExpressionUUID->"ad3720ee-1edd-4027-92cc-\
878e2f9f7e3f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"getbklm", "[", 
   RowBox[{"1", ",", "1", ",", "\"\<GR1\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.939965091395553*^9, 3.939965093562831*^9}, {
  3.939965137923699*^9, 3.939965142374892*^9}, {3.9399651730155354`*^9, 
  3.939965204023747*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"85759cf2-e160-45d5-8e05-20d7c1ed9143"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "10.254031`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "704"}],
  SequenceForm[
  "Integration time=", 10.254031, "; Number of terms in the expression: ", 
   704],
  Editable->False]], "Print",
 CellChangeTimes->{3.939965216380066*^9, 3.939966452181806*^9, 
  3.939966636914092*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"1b720a74-b44d-4c1d-a397-332324f2b591"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Simplifcation time=\"\>", "\[InvisibleSpace]", "2.221876`"}],
  SequenceForm["Simplifcation time=", 2.221876],
  Editable->False]], "Print",
 CellChangeTimes->{3.939965216380066*^9, 3.939966452181806*^9, 
  3.9399666391306953`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"e59b05ea-c466-4e29-b5b3-c0042486f4ed"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<=", "3"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"getbklm", "[", 
    RowBox[{"3", ",", "i", " ", ",", "\"\<GR1\>\""}], "]"}]}], "]"}]], "Input",\

 CellChangeTimes->{3.9399651920843678`*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"259b56aa-3695-4a24-b01f-4dde55a90c48"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "28.085988`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "887"}],
  SequenceForm[
  "Integration time=", 28.085988, "; Number of terms in the expression: ", 
   887],
  Editable->False]], "Print",
 CellChangeTimes->{3.939965250776834*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"8cabe5db-9a11-46c8-a050-834841b571e5"],

Cell[BoxData["9.044655`"], "Print",
 CellChangeTimes->{3.9399652596436872`*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"915ccec4-045f-4cd5-9a0a-76c627104f31"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "17.593844`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "637"}],
  SequenceForm[
  "Integration time=", 17.593844, "; Number of terms in the expression: ", 
   637],
  Editable->False]], "Print",
 CellChangeTimes->{3.939965276549913*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"1158beb9-62a2-4f95-b898-a1a47dc94d9d"],

Cell[BoxData["6.621215`"], "Print",
 CellChangeTimes->{3.9399652830446367`*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"32083770-076d-4645-922a-90245259dbc5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "12.814212`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "393"}],
  SequenceForm[
  "Integration time=", 12.814212, "; Number of terms in the expression: ", 
   393],
  Editable->False]], "Print",
 CellChangeTimes->{3.939965295569944*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"a8ed5f22-6e43-490f-923d-f2c3d0e3dfe6"],

Cell[BoxData["4.598785`"], "Print",
 CellChangeTimes->{3.939965300073859*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"e97978e9-baa2-424e-bbf3-8c4b76080520"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "10.328986`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "184"}],
  SequenceForm[
  "Integration time=", 10.328986, "; Number of terms in the expression: ", 
   184],
  Editable->False]], "Print",
 CellChangeTimes->{3.939965310059395*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"353132c6-576c-4adf-9afb-3da2d7eaa060"],

Cell[BoxData["1.376882`"], "Print",
 CellChangeTimes->{3.939965311416626*^9},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"629b5e7d-1b05-4e67-9dce-e04e64985da4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getbklm", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<GR0\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"getbklm", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<GR2\>\""}], "]"}], "\n"}], "Input",
 CellChangeTimes->{3.9399651998721848`*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"14c4617a-6ca8-436d-90ae-17592b562c00"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "4.887934`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "710"}],
  SequenceForm[
  "Integration time=", 4.887934, "; Number of terms in the expression: ", 710],
  Editable->False]], "Print",
 CellChangeTimes->{3.9399653161897993`*^9},
 CellLabel->
  "During evaluation of \
In[109]:=",ExpressionUUID->"277b717a-eddb-4a05-9b4c-05a1a19b029e"],

Cell[BoxData["4.234639`"], "Print",
 CellChangeTimes->{3.9399653202994328`*^9},
 CellLabel->
  "During evaluation of \
In[109]:=",ExpressionUUID->"e296ccad-7fdb-4686-bf49-3f44f6c9702c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "5.310046`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "1816"}],
  SequenceForm[
  "Integration time=", 5.310046, "; Number of terms in the expression: ", 
   1816],
  Editable->False]], "Print",
 CellChangeTimes->{3.939965325434596*^9},
 CellLabel->
  "During evaluation of \
In[109]:=",ExpressionUUID->"22e7ea59-a845-45ea-aed0-d5e15a62e631"],

Cell[BoxData["28.347014`"], "Print",
 CellChangeTimes->{3.939965352925789*^9},
 CellLabel->
  "During evaluation of \
In[109]:=",ExpressionUUID->"afb876e6-5b10-4fbe-939f-d615be2d1077"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Primordial non-Gaussian contributions", "Section",
 CellChangeTimes->{{3.932055804209683*^9, 3.93205581815631*^9}, {
   3.939881518713078*^9, 3.939881522853476*^9}, 3.939965689961369*^9, {
   3.9399670952143307`*^9, 3.939967105166802*^9}, 
   3.939985005544573*^9},ExpressionUUID->"8c319aea-904a-44de-af21-\
b87a8dddc8f0"],

Cell["\<\
This computes all permutations keeping only terms linear in fnl.\
\>", "Text",
 CellChangeTimes->{{3.9399657127613783`*^9, 
  3.93996573416988*^9}},ExpressionUUID->"0af5d70c-4fcf-49c3-8c97-\
fcdcba46befc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"initial", " ", "bispectrum"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BI", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"M", "[", 
        RowBox[{"Norm", "[", "q1", "]"}], "]"}], 
       RowBox[{"M", "[", 
        RowBox[{"Norm", "[", "q2", "]"}], "]"}], 
       RowBox[{"M", "[", 
        RowBox[{"Norm", "[", "q3", "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KN1", "[", 
          RowBox[{"q1", ",", "x1"}], "]"}], "/", 
         RowBox[{"D1", "[", "x1", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KN1", "[", 
          RowBox[{"q2", ",", "x2"}], "]"}], "/", 
         RowBox[{"D1", "[", "x2", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KN1", "[", 
          RowBox[{"q3", ",", "x3"}], "]"}], "/", 
         RowBox[{"D1", "[", "x3", "]"}]}], ")"}]}], "/.", 
      "simpletensorexpand"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"BLoc", "[", 
       RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}], " ", ";"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KNG1", "[", 
      RowBox[{"q1_", ",", "x1_", ",", "alpha_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"KN1", "[", 
       RowBox[{"q1", ",", "x1"}], "]"}], "+", 
      RowBox[{"KN1PNG", "[", 
       RowBox[{"q1", ",", "x1", ",", "alpha"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KNG2", "[", 
     RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "x1_", ",", "alpha_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"KN2", "[", 
      RowBox[{"q1", ",", "q2", ",", "x1"}], "]"}], "+", 
     RowBox[{"KN2PNG", "[", 
      RowBox[{"q1", ",", "q2", ",", "x1", ",", "alpha"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BkpermPNG", "[", 
     RowBox[{
     "q1_", ",", "q2_", ",", "q3_", ",", "x1_", ",", "x2_", ",", "x3_", ",", 
      "alpha_"}], "]"}], " ", ":=", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"KNG1", "[", 
       RowBox[{"q1", ",", "x1", ",", "alpha"}], "]"}], 
      RowBox[{"KNG1", "[", 
       RowBox[{"q2", ",", "x2", ",", "alpha"}], "]"}], 
      RowBox[{"KNG2", "[", 
       RowBox[{"q1", ",", "q2", ",", "q3", ",", "x3", ",", "alpha"}], "]"}], 
      RowBox[{"P", "[", 
       RowBox[{"Norm", "[", "q1", "]"}], "]"}], 
      RowBox[{"P", "[", 
       RowBox[{"Norm", "[", "q2", "]"}], "]"}]}], "/.", 
     "simpletensorexpand"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getlinearfnl", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=", " ", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"expr", ",", 
           RowBox[{"{", 
            RowBox[{"fNL", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"expr0", " ", "=", 
        RowBox[{"expr", "/.", 
         RowBox[{"{", 
          RowBox[{"fNL", "->", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"expr1", " ", "=", " ", 
        RowBox[{
         RowBox[{"temp", "-", "expr0"}], " ", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SuperscriptBox["fNL", 
             RowBox[{"(", 
              RowBox[{"n_", ":", "1"}], ")"}]], "/;", 
            RowBox[{"n", ">=", "2"}]}], "->", " ", "0"}], "}"}]}]}]}]}], 
     "]"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"combine", " ", "all", " ", "perms"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bkrsd", "[", "alpha_", "]"}], " ", ":=", 
    RowBox[{"getlinearfnl", "[", 
     RowBox[{
      RowBox[{"BkpermPNG", "[", 
       RowBox[{
       "q1", ",", "q2", ",", "q3", ",", "x1", ",", "x2", ",", "x3", ",", 
        "alpha"}], "]"}], "+", 
      RowBox[{"BkpermPNG", "[", 
       RowBox[{
       "q1", ",", "q3", ",", "q2", ",", "x1", ",", "x3", ",", "x2", ",", 
        "alpha"}], "]"}], "+", " ", 
      RowBox[{"BkpermPNG", "[", 
       RowBox[{
       "q2", ",", "q3", ",", "q1", ",", "x2", ",", "x3", ",", "x1", ",", 
        "alpha"}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939875095454542*^9, 3.9398751034779787`*^9}, {
   3.939875572463331*^9, 3.93987566857108*^9}, {3.939876017627995*^9, 
   3.939876028244505*^9}, 3.939876282343533*^9, {3.939876505193686*^9, 
   3.9398765064052277`*^9}, {3.939876847288947*^9, 3.9398768474810762`*^9}, {
   3.939876878549073*^9, 3.939876992323165*^9}, {3.939877046952176*^9, 
   3.939877068258806*^9}, {3.93987734084848*^9, 3.93987734713206*^9}, 
   3.93987838941453*^9, {3.939878460393824*^9, 3.939878523648485*^9}, {
   3.939878739383239*^9, 3.939878832529958*^9}, {3.939878954932378*^9, 
   3.939878999687892*^9}, {3.9398790310851316`*^9, 3.939879049428553*^9}, {
   3.93987930671799*^9, 3.939879346905778*^9}, {3.939879399754393*^9, 
   3.939879430695402*^9}, {3.939879493224209*^9, 3.939879522256542*^9}, {
   3.939879724689455*^9, 3.939879781574994*^9}, {3.939879953155306*^9, 
   3.939880069130145*^9}, 3.9398802191705933`*^9, {3.9398802822084417`*^9, 
   3.939880317249445*^9}, {3.939881982482794*^9, 3.939881987102953*^9}, 
   3.939882193964731*^9, 3.939898081757025*^9, 3.939965737070897*^9, {
   3.9399757641023207`*^9, 3.939975798858987*^9}, {3.939986568362761*^9, 
   3.9399865719778748`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"6ad7779a-ce06-48d8-812d-35fd00578542"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bkdict", "[", "\"\<PNGLoc\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Bkrsd", "[", "0", "]"}], "+", " ", 
        RowBox[{"BI", " ", 
         RowBox[{"BLoc", "[", 
          RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}]}]}], ")"}], "/.", 
      "removederiv"}], "/.", "removewa"}], "//.", "cleantoexport"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bkdict", "[", "\"\<PNGEq\>\"", "]"}], "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Bkrsd", "[", "2", "]"}], "+", " ", 
        RowBox[{"BI", " ", 
         RowBox[{"BEq", "[", 
          RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}]}]}], ")"}], "/.", 
      "removederiv"}], "/.", "removewa"}], "//.", "cleantoexport"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bkdict", "[", "\"\<PNGOrth\>\"", "]"}], "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Bkrsd", "[", "1", "]"}], "+", " ", 
        RowBox[{"BI", " ", 
         RowBox[{"BOrth", "[", 
          RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}]}]}], ")"}], "/.", 
      "removederiv"}], "/.", "removewa"}], "//.", "cleantoexport"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9398819291414757`*^9, 3.939881960025564*^9}, {
  3.93988199181783*^9, 3.939881998473674*^9}, {3.9398820858224297`*^9, 
  3.939882122111039*^9}, {3.939882164083955*^9, 3.9398821657204037`*^9}, {
  3.939882205796453*^9, 3.939882234696184*^9}, {3.9398980000698137`*^9, 
  3.9398980192679167`*^9}, {3.9398981708799677`*^9, 3.93989817575264*^9}, {
  3.939898218730199*^9, 3.939898244685257*^9}, {3.9399009640375834`*^9, 
  3.9399009722953587`*^9}, {3.939946813923856*^9, 3.9399468285151653`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"9874e54e-f396-4dd2-8725-8564865261d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bkdict", "[", "\"\<PNGOrth\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.939891541842517*^9, {3.939898192803583*^9, 3.9398981967921867`*^9}, {
   3.939898228114757*^9, 3.939898230484323*^9}, {3.9398982615736322`*^9, 
   3.939898266172758*^9}, {3.93989954802151*^9, 3.939899551027946*^9}, {
   3.939944105720344*^9, 3.939944106728011*^9}, 3.9399478636159077`*^9, {
   3.9399490611318197`*^9, 3.939949065058585*^9}, 3.93996638396751*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"dd546e41-a0ba-41b9-9b3e-cc5436b453d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getbklm", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<PNGLoc\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.939966378118841*^9, 3.939966389499398*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"16ea253e-28f2-45cb-8abd-8de1d9ee1c74"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "4.72611`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "775"}],
  SequenceForm[
  "Integration time=", 4.72611, "; Number of terms in the expression: ", 775],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.9399671566495657`*^9, 3.939969014640449*^9, 
  3.9399691366319513`*^9, 3.9399863533356123`*^9, 3.939986591332934*^9, 
  3.94005273897265*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"8da85b7c-3d0d-44b7-b046-3b90df89de02"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Simplifcation time=\"\>", "\[InvisibleSpace]", "7.905503`"}],
  SequenceForm["Simplifcation time=", 7.905503],
  Editable->False]], "Print",
 CellChangeTimes->{3.9399671566495657`*^9, 3.939969014640449*^9, 
  3.9399691366319513`*^9, 3.9399863533356123`*^9, 3.939986591332934*^9, 
  3.940052746755837*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"2ecbcf9d-95fd-4217-8c8d-2b56257e1ed9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getbklm", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<PNGEq\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.939966381170924*^9, 3.939966395063513*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"6ef72eac-5ede-436d-b9d5-1c2c8d77c7b8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "5.1196`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "971"}],
  SequenceForm[
  "Integration time=", 5.1196, "; Number of terms in the expression: ", 971],
  Editable->False]], "Print",
 CellChangeTimes->{3.9399690196376762`*^9, 3.939969141590967*^9, 
  3.939986366517305*^9, 3.939986603373231*^9, 3.940052751728776*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"d4778a38-9636-491f-a222-cc019f1d85f0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Simplifcation time=\"\>", "\[InvisibleSpace]", "57.784129`"}],
  SequenceForm["Simplifcation time=", 57.784129],
  Editable->False]], "Print",
 CellChangeTimes->{3.9399690196376762`*^9, 3.939969141590967*^9, 
  3.939986366517305*^9, 3.939986603373231*^9, 3.940052808839761*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"0ae7b46f-f974-4864-855b-c84eca2b8000"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getbklm", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<PNGOrth\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.939946772238666*^9, 3.939946798665553*^9}, {
  3.939947870966968*^9, 3.9399478872064247`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"1a0072d7-520a-46ca-aee6-918401584e01"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "5.12401`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "971"}],
  SequenceForm[
  "Integration time=", 5.12401, "; Number of terms in the expression: ", 971],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.939946805451939*^9, 3.939947272514509*^9, 
  3.9399478777966337`*^9, 3.939947942259295*^9, 3.939967167353261*^9, 
  3.939969033773486*^9, 3.939969155129416*^9, 3.9399864239768877`*^9, 
  3.939986664263639*^9, 3.940052813805471*^9},
 CellLabel->
  "During evaluation of \
In[191]:=",ExpressionUUID->"b55cf6e6-7b8e-4a50-bea8-44574e02660a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Simplifcation time=\"\>", "\[InvisibleSpace]", "23.148682`"}],
  SequenceForm["Simplifcation time=", 23.148682],
  Editable->False]], "Print",
 CellChangeTimes->{3.939946805451939*^9, 3.939947272514509*^9, 
  3.9399478777966337`*^9, 3.939947942259295*^9, 3.939967167353261*^9, 
  3.939969033773486*^9, 3.939969155129416*^9, 3.9399864239768877`*^9, 
  3.939986664263639*^9, 3.940052836586083*^9},
 CellLabel->
  "During evaluation of \
In[191]:=",ExpressionUUID->"24e3cdfd-1d9c-49e5-a56b-059ea1eee3dd"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Multipole Covariance", "Section",
 CellChangeTimes->{{3.9223344409167957`*^9, 3.9223344554028893`*^9}, {
  3.928389860739697*^9, 
  3.9283898675561666`*^9}},ExpressionUUID->"0a7b04ce-8476-4178-b78f-\
5ca777749257"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"l", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SphHarm", "[", 
   RowBox[{"l_", ",", "m_", ",", " ", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"ExpToTrig", "[", " ", 
   RowBox[{"SphericalHarmonicY", "[", 
    RowBox[{"l", ",", "m", ",", " ", "\[Theta]", ",", "\[Phi]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PNPP", "[", 
    RowBox[{"k_", ",", "d_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"KN1", "[", 
      RowBox[{"k", ",", "d"}], "]"}], "^", "2"}], 
    RowBox[{"P", "[", 
     RowBox[{"Norm", "[", "k", "]"}], "]"}]}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"+", " ", "1"}], "/", "nbar"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaussint", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SphHarm", "[", 
          RowBox[{"l", ",", "m", ",", " ", "theta1", ",", "\[Phi]"}], "]"}], 
         " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"SphHarm", "[", 
           RowBox[{"l", ",", "m", ",", " ", "theta1", ",", "\[Phi]"}], "]"}], 
          "]"}], " ", 
         RowBox[{"PNPP", "[", 
          RowBox[{"q1", ",", "d"}], "]"}], " ", 
         RowBox[{"PNPP", "[", 
          RowBox[{"q2", ",", "d"}], "]"}], 
         RowBox[{"PNPP", "[", 
          RowBox[{"q3", ",", "d"}], "]"}]}], ")"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n_", ":", "1"}], ")"}], "q1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n_", ":", "1"}], ")"}], "q2"}]}], ")"}], ".", "d"}], "->", 
         RowBox[{
          RowBox[{"n", " ", 
           RowBox[{"q1", ".", "d"}]}], "+", 
          RowBox[{"n", " ", 
           RowBox[{"q2", ".", "d"}]}]}]}], "}"}]}], "//.", "removederiv"}], "//.",
      "cleantoexport"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "theta1", "]"}], "->", "mu"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "theta1", "]"}], "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"mu", "^", "2"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
      RowBox[{"mu2", "->", 
       RowBox[{
        RowBox[{"mu", " ", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "+", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"mu", "^", "2"}]}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}]}], " ", 
         RowBox[{"Sin", "[", "theta", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cov", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", " ", "\[Pi]"}], ")"}], "/", "Ntri"}], "  ", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{"gaussint", " ", ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "0", ",", 
          RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}], "]"}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"mu", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "\"\</home/chris/Documents/Wolfram Mathematica/cov\>\"", ",", 
      "\"\<l\>\"", ",", 
      RowBox[{"ToString", "[", "l", "]"}], ",", "\"\<m\>\"", ",", 
      RowBox[{"ToString", "[", "m", "]"}], ",", "\"\<.json\>\""}], "]"}], ",", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"cov", "/.", "pkrules"}], " ", ",", "InputForm"}], "]"}], ",", 
    "\"\<JSON\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9283898911375628`*^9, {3.928390547998395*^9, 3.928390586021484*^9}, {
   3.941169883657226*^9, 3.941169890646122*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"80450489-b12d-45a6-9465-07939a8709a9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"45045", " ", 
    SuperscriptBox["k3", "4"], " ", "Ntri"}]], 
  RowBox[{"4", " ", 
   SuperscriptBox["D1", "6"], " ", "\[Pi]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"9009", " ", 
      SuperscriptBox["b1", "4"], " ", 
      SuperscriptBox["f", "2"], " ", 
      SuperscriptBox["k1", "4"]}], "+", 
     RowBox[{"20592", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", 
      SuperscriptBox["k1", "4"]}], "+", 
     RowBox[{"19019", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k1", "4"]}], "+", 
     RowBox[{"8450", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "4"]}], "+", 
     RowBox[{"1575", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k1", "4"]}], "+", 
     RowBox[{"36036", " ", 
      SuperscriptBox["b1", "4"], " ", 
      SuperscriptBox["f", "2"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"]}], "+", 
     RowBox[{"92664", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"]}], "+", 
     RowBox[{"96096", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"]}], "+", 
     RowBox[{"46800", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"]}], "+", 
     RowBox[{"9000", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"]}], "+", 
     RowBox[{"9009", " ", 
      SuperscriptBox["b1", "4"], " ", 
      SuperscriptBox["f", "2"], " ", 
      SuperscriptBox["k2", "4"]}], "+", 
     RowBox[{"20592", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", 
      SuperscriptBox["k2", "4"]}], "+", 
     RowBox[{"19019", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k2", "4"]}], "+", 
     RowBox[{"8450", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k2", "4"]}], "+", 
     RowBox[{"1575", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k2", "4"]}], "+", 
     RowBox[{"30030", " ", 
      SuperscriptBox["b1", "5"], " ", "f", " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"60060", " ", 
      SuperscriptBox["b1", "4"], " ", 
      SuperscriptBox["f", "2"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"51480", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"21736", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"3900", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"30030", " ", 
      SuperscriptBox["b1", "5"], " ", "f", " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"60060", " ", 
      SuperscriptBox["b1", "4"], " ", 
      SuperscriptBox["f", "2"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"51480", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"21736", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"3900", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["k3", "2"]}], "+", 
     RowBox[{"45045", " ", 
      SuperscriptBox["b1", "6"], " ", 
      SuperscriptBox["k3", "4"]}], "+", 
     RowBox[{"60060", " ", 
      SuperscriptBox["b1", "5"], " ", "f", " ", 
      SuperscriptBox["k3", "4"]}], "+", 
     RowBox[{"42042", " ", 
      SuperscriptBox["b1", "4"], " ", 
      SuperscriptBox["f", "2"], " ", 
      SuperscriptBox["k3", "4"]}], "+", 
     RowBox[{"15444", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", 
      SuperscriptBox["k3", "4"]}], "+", 
     RowBox[{"2574", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k3", "4"]}], "+", 
     RowBox[{"4", " ", "f", " ", "k1", " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2625", " ", 
         SuperscriptBox["f", "5"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["k1", "2"], "+", 
           SuperscriptBox["k2", "2"]}], ")"}]}], "+", 
        RowBox[{"15015", " ", 
         SuperscriptBox["b1", "5"], " ", 
         SuperscriptBox["k3", "2"]}], "+", 
        RowBox[{"9009", " ", 
         SuperscriptBox["b1", "4"], " ", "f", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["k1", "2"], "+", 
           SuperscriptBox["k2", "2"], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["k3", "2"]}]}], ")"}]}], "+", 
        RowBox[{"325", " ", "b1", " ", 
         SuperscriptBox["f", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"41", " ", 
            SuperscriptBox["k1", "2"]}], "+", 
           RowBox[{"41", " ", 
            SuperscriptBox["k2", "2"]}], "+", 
           RowBox[{"10", " ", 
            SuperscriptBox["k3", "2"]}]}], ")"}]}], "+", 
        RowBox[{"715", " ", 
         SuperscriptBox["b1", "2"], " ", 
         SuperscriptBox["f", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"37", " ", 
            SuperscriptBox["k1", "2"]}], "+", 
           RowBox[{"37", " ", 
            SuperscriptBox["k2", "2"]}], "+", 
           RowBox[{"24", " ", 
            SuperscriptBox["k3", "2"]}]}], ")"}]}], "+", 
        RowBox[{"1287", " ", 
         SuperscriptBox["b1", "3"], " ", 
         SuperscriptBox["f", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"19", " ", 
            SuperscriptBox["k1", "2"]}], "+", 
           RowBox[{"19", " ", 
            SuperscriptBox["k2", "2"]}], "+", 
           RowBox[{"28", " ", 
            SuperscriptBox["k3", "2"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "theta", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["f", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"15", " ", 
         SuperscriptBox["f", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"112", " ", 
            SuperscriptBox["k1", "4"]}], "+", 
           RowBox[{"675", " ", 
            SuperscriptBox["k1", "2"], " ", 
            SuperscriptBox["k2", "2"]}], "+", 
           RowBox[{"112", " ", 
            SuperscriptBox["k2", "4"]}]}], ")"}]}], "+", 
        RowBox[{"260", " ", "b1", " ", 
         SuperscriptBox["f", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"29", " ", 
            SuperscriptBox["k1", "4"]}], "+", 
           RowBox[{"29", " ", 
            SuperscriptBox["k2", "4"]}], "+", 
           RowBox[{"15", " ", 
            SuperscriptBox["k2", "2"], " ", 
            SuperscriptBox["k3", "2"]}], "+", 
           RowBox[{"15", " ", 
            SuperscriptBox["k1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"12", " ", 
               SuperscriptBox["k2", "2"]}], "+", 
              SuperscriptBox["k3", "2"]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"6006", " ", 
         SuperscriptBox["b1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["k3", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["k2", "2"], "+", 
              SuperscriptBox["k3", "2"]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["k1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox["k2", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["k3", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"5148", " ", 
         SuperscriptBox["b1", "3"], " ", "f", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["k1", "4"], "+", 
           SuperscriptBox["k2", "4"], "+", 
           RowBox[{"5", " ", 
            SuperscriptBox["k2", "2"], " ", 
            SuperscriptBox["k3", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["k3", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["k1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"12", " ", 
               SuperscriptBox["k2", "2"]}], "+", 
              RowBox[{"5", " ", 
               SuperscriptBox["k3", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"572", " ", 
         SuperscriptBox["b1", "2"], " ", 
         SuperscriptBox["f", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"19", " ", 
            SuperscriptBox["k1", "4"]}], "+", 
           RowBox[{"19", " ", 
            SuperscriptBox["k2", "4"]}], "+", 
           RowBox[{"31", " ", 
            SuperscriptBox["k2", "2"], " ", 
            SuperscriptBox["k3", "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["k3", "4"]}], "+", 
           RowBox[{
            SuperscriptBox["k1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"141", " ", 
               SuperscriptBox["k2", "2"]}], "+", 
              RowBox[{"31", " ", 
               SuperscriptBox["k3", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}], 
      " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"5148", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", 
      SuperscriptBox["k1", "3"], " ", "k2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"14300", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k1", "3"], " ", "k2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"11960", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "3"], " ", "k2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"3150", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k1", "3"], " ", "k2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"5148", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", "k1", " ", 
      SuperscriptBox["k2", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"14300", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", "k1", " ", 
      SuperscriptBox["k2", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"11960", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", "k1", " ", 
      SuperscriptBox["k2", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"3150", " ", 
      SuperscriptBox["f", "6"], " ", "k1", " ", 
      SuperscriptBox["k2", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"10296", " ", 
      SuperscriptBox["b1", "3"], " ", 
      SuperscriptBox["f", "3"], " ", "k1", " ", "k2", " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"11440", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", "k1", " ", "k2", " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"3250", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", "k1", " ", "k2", " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"143", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k1", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"390", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"210", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k1", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"3432", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"4680", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"1620", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"143", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k2", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"390", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k2", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"210", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k2", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"572", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"390", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"572", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"390", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"143", " ", 
      SuperscriptBox["b1", "2"], " ", 
      SuperscriptBox["f", "4"], " ", 
      SuperscriptBox["k3", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"260", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", 
      SuperscriptBox["k1", "3"], " ", "k2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"210", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k1", "3"], " ", "k2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"260", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", "k1", " ", 
      SuperscriptBox["k2", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"210", " ", 
      SuperscriptBox["f", "6"], " ", "k1", " ", 
      SuperscriptBox["k2", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"130", " ", "b1", " ", 
      SuperscriptBox["f", "5"], " ", "k1", " ", "k2", " ", 
      SuperscriptBox["k3", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", "theta"}], "]"}]}], "+", 
     RowBox[{"45", " ", 
      SuperscriptBox["f", "6"], " ", 
      SuperscriptBox["k1", "2"], " ", 
      SuperscriptBox["k2", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"6", " ", "theta"}], "]"}]}]}], ")"}], " ", 
   RowBox[{"P", "[", "k1", "]"}], " ", 
   RowBox[{"P", "[", "k2", "]"}], " ", 
   RowBox[{"P", "[", "k3", "]"}]}]}]], "Output",
 CellChangeTimes->{3.9411697502431383`*^9, 3.941170025775053*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"0107b63c-922c-413f-95b6-69b31b94511e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wide-separation Terms", "Section",
 CellChangeTimes->{{3.920186897171543*^9, 3.92018690889657*^9}, {
  3.9223344202580976`*^9, 3.922334421545923*^9}, {3.939965831639976*^9, 
  3.9399658335643167`*^9}},ExpressionUUID->"c6ffb7e9-e751-4183-b478-\
227b2e3901d1"],

Cell["\<\
So starting from our local bispectrum we need to series expand our LOS \
dependence\
\>", "Text",
 CellChangeTimes->{{3.939965794518998*^9, 3.939965886112912*^9}, {
  3.939967178335969*^9, 
  3.939967180147559*^9}},ExpressionUUID->"d1c5b971-0a2b-42a7-8149-\
133896127bff"],

Cell[CellGroupData[{

Cell["\<\
Considering a single permutation (expressions are very loooong)\
\>", "Subsubsection",
 CellChangeTimes->{
  3.93996337763*^9, {3.939963432814506*^9, 3.939963456187017*^9}, 
   3.939964893809638*^9, {3.9399658503520403`*^9, 
   3.939965868436499*^9}},ExpressionUUID->"ee7876c7-aa0e-4b34-9dcc-\
fbde48525c8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Pick", " ", "Perm", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], "or", " ", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"perm", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fullperm", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";", 
    RowBox[{"permorder", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{"perm", ",", 
       RowBox[{"Complement", "[", 
        RowBox[{"fullperm", ",", "perm"}], "]"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"so", " ", "set", " ", "order", " ", "from", " ", "perm"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"permargs", " ", ":=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}], "[", 
        RowBox[{"[", "permorder", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "[", 
        RowBox[{"[", "permorder", "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"[", 
       RowBox[{"q1", ",", "q2", ",", "q3", ",", "x1", ",", "x2", ",", "x3"}], 
       "]"}], " ", "[", 
      RowBox[{"q1", ",", "q3", ",", "q2", ",", "x1", ",", "x3", ",", "x2"}], 
      "]"}], " ", "[", 
     RowBox[{"q2", ",", "q3", ",", "q1", ",", "x2", ",", "x3", ",", "x1"}], 
     "]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bkpart", " ", "=", " ", 
     RowBox[{
      RowBox[{"Bkperm", "@@", "permargs"}], "/.", "simpletensorexpand"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bkperms", "=", " ", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{"Bkpart", ",", 
        RowBox[{"{", 
         RowBox[{"H", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR0", " ", "=", " ", 
     RowBox[{"Bkperms", " ", "/.", 
      RowBox[{"{", 
       RowBox[{"H", "->", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR1", " ", "=", " ", 
     RowBox[{
      RowBox[{"Bkperms", " ", "-", "GR0"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"H", "^", "2"}], "->", "0"}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"(", 
      RowBox[{"H", "/", "k"}], ")"}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GR2", " ", "=", " ", 
     RowBox[{"Bkperms", " ", "-", " ", "GR0", " ", "-", " ", "GR1"}]}], " ", 
    RowBox[{"(*", 
     RowBox[{"check", " ", 
      RowBox[{"it", "'"}], "s", " ", 
      RowBox[{"H", "^", "2"}]}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"H", "/", "k"}], ")"}], "^", "2"}], "*)"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.9399633398561707`*^9, 
  3.9399633590542*^9}},ExpressionUUID->"f4961d04-eed2-4be2-99ad-3f6138e7842f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Mix", " ", "Gr", " ", "and", " ", "wide", " ", "angle"}], " ", 
     "-", " ", 
     RowBox[{
     "So", " ", "get", " ", "each", " ", "1", "st", " ", "order", " ", "x", 
      " ", "1", "st", " ", "GR", " ", "Contribution"}]}], "..."}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"wideangleexp1", " ", ":=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"wa1x1", ",", " ", "wa1x2", ",", " ", "wa1x3"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WAGR", " ", "=", 
     RowBox[{
      RowBox[{"calculateWideAngleExpansion1", "[", 
       RowBox[{"wideangleexp1", ",", "GR1"}], "]"}], "//.", "removederiv"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RRGR", " ", "=", " ", 
     RowBox[{
      RowBox[{"calculateWideAngleExpansion1", "[", 
       RowBox[{"deriv1", ",", "GR1"}], "]"}], "//.", "removewa"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.911042544701503*^9, 3.91104259751799*^9}, {
  3.911322861300954*^9, 3.911322922905851*^9}, {3.911325467338119*^9, 
  3.911325484640258*^9}, {3.911326815682891*^9, 3.9113268489633503`*^9}, {
  3.911573750395718*^9, 3.9115737514666348`*^9}, {3.911885196214929*^9, 
  3.911885231881942*^9}, {3.9149246955173903`*^9, 3.9149247040650883`*^9}, {
  3.9149318262250547`*^9, 3.914931865908773*^9}, {3.915165285409831*^9, 
  3.915165316594849*^9}, {3.915165365156433*^9, 3.9151653661600637`*^9}, {
  3.9151689081100397`*^9, 3.915168909736685*^9}, {3.915178956333399*^9, 
  3.9151789915485573`*^9}, {3.9199163895867147`*^9, 3.919916389761492*^9}, {
  3.921683225586659*^9, 3.9216832258068237`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"2f47b5f5-dfab-4d8c-b1b1-6274ae8c71eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "wide", " ", "angle", " ", "and", " ", "radial", " ", "redhsift", " ", 
     "term", " ", "contribution"}], "..."}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"wideangleexp", " ", ":=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"wa2x1", ",", " ", "wa2x2", ",", " ", "wa2x3"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"mixedexp", " ", ":=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{"wa1x1", ",", " ", "wa1x2", ",", " ", "wa1x3", ",", "deriv1"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"pure", " ", "parts"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NWA1", ",", "NWA2"}], "}"}], " ", "=", 
     RowBox[{
      RowBox[{"calculateWideAngleExpansions", "[", "wideangleexp", "]"}], "/.",
       "removederiv"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"standard", " ", "wide", " ", "angle", " ", "terms"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NRR1", ",", "NRR2"}], "}"}], " ", "=", 
     RowBox[{
      RowBox[{"calculateWideAngleExpansions", "[", "deriv2", "]"}], "//.", 
      "removewa"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"derivative", " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Nmix1tmp", ",", "Nmix2tmp"}], "}"}], " ", "=", 
     RowBox[{"calculateWideAngleExpansions", "[", "mixedexp", "]"}]}], ";"}], 
   
   RowBox[{"(*", 
    RowBox[{"mixed", " ", "terms"}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
    "so", " ", "get", " ", "mixed", " ", "terms", " ", "and", " ", "make", 
     " ", "sure", " ", "it", " ", "doesnt", " ", "have", " ", "other", " ", 
     "parts"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp", " ", "=", " ", 
     RowBox[{"Collect", "[", 
      RowBox[{"Nmix2tmp", ",", 
       RowBox[{"{", "c", "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "so", " ", "we", " ", "can", " ", "just", " ", "select", " ", "the", " ", 
     
     RowBox[{"c", "^", "1"}], " ", "parts"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NWARR", " ", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"temp", " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"temp", "/.", 
            RowBox[{"{", 
             RowBox[{"c", "->", "0"}], "}"}]}], ")"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "^", "2"}], "->", "0"}], "}"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"c", "->", "1"}], "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.910777902464068*^9, 3.9107779048808317`*^9}, 
   3.910778047289008*^9, {3.910778458776518*^9, 3.91077849338441*^9}, {
   3.910778920601753*^9, 3.910779017166129*^9}, {3.910779085114764*^9, 
   3.9107791227333517`*^9}, {3.910780332958803*^9, 3.9107803669424963`*^9}, {
   3.910780573556464*^9, 3.9107805956034307`*^9}, {3.910780940958396*^9, 
   3.910781008408702*^9}, {3.910783332572681*^9, 3.910783342296533*^9}, {
   3.910783711948024*^9, 3.91078372091605*^9}, {3.910785751428543*^9, 
   3.910785803588787*^9}, {3.910787509199717*^9, 3.910787512342568*^9}, {
   3.910788098663216*^9, 3.910788101946488*^9}, {3.910788217915216*^9, 
   3.9107882521298313`*^9}, {3.910793922529673*^9, 3.910793925996213*^9}, 
   3.9108541722739897`*^9, {3.910859957687436*^9, 3.910859962548513*^9}, 
   3.910860052492008*^9, {3.910861030175391*^9, 3.910861041018921*^9}, {
   3.9110407515163927`*^9, 3.911040757145949*^9}, {3.9113064944392776`*^9, 
   3.911306499767507*^9}, 3.911307160346519*^9, {3.91130722674746*^9, 
   3.911307234075074*^9}, {3.911307273508173*^9, 3.911307291160825*^9}, {
   3.9113715032411346`*^9, 3.911371505635015*^9}, {3.911573741812096*^9, 
   3.911573743107053*^9}, {3.911885236614645*^9, 3.9118852377870903`*^9}, {
   3.914924708969906*^9, 3.9149247211054907`*^9}, 3.91493319804732*^9, 
   3.914933236330769*^9, {3.919916190957835*^9, 3.919916194100863*^9}, {
   3.9199164084460793`*^9, 3.9199164140422792`*^9}, {3.921683184365921*^9, 
   3.921683185486594*^9}, {3.92478989110909*^9, 3.924789896473237*^9}, 
   3.9250379287424*^9, {3.925128960407586*^9, 3.9251289613420362`*^9}, 
   3.92518013973407*^9, {3.925277743368135*^9, 3.925277760875436*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"c75526ad-f760-4879-ad06-19d79985ab29"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Length of WARR expression = \>\"", ",", 
   RowBox[{"Length", "[", 
    RowBox[{"Expand", "[", "NWARR", "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Length of 2nd order RR expression = \>\"", ",", 
   RowBox[{"Length", "[", 
    RowBox[{"Expand", "[", "NRR2", "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Length of 2nd order WA expression = \>\"", ",", 
   RowBox[{"Length", "[", 
    RowBox[{"Expand", "[", "NWA2", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.910854176952469*^9, 3.9108541803283978`*^9}, {
  3.910854321872406*^9, 3.910854340053491*^9}, {3.910862654352077*^9, 
  3.910862665696294*^9}, {3.910863115102927*^9, 3.910863115680472*^9}, {
  3.91130647245532*^9, 3.911306474982683*^9}, {3.911306536087467*^9, 
  3.911306542487467*^9}, {3.911307244383259*^9, 3.9113072480349407`*^9}, {
  3.911322953699185*^9, 3.911322961570065*^9}, {3.911885308933381*^9, 
  3.9118853181777163`*^9}, {3.91188535077999*^9, 3.91188540748566*^9}, {
  3.91318119498248*^9, 3.913181200269331*^9}, {3.914926971526371*^9, 
  3.9149269926026297`*^9}, {3.920179606243391*^9, 3.920179606414845*^9}, {
  3.92018914923326*^9, 3.920189158390871*^9}, {3.921683195094359*^9, 
  3.921683195978568*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"58f36aad-b70a-41e5-920f-f00316a2b9ec"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Length of WARR expression = \"\>", "\[InvisibleSpace]", 
   "6578"}],
  SequenceForm["Length of WARR expression = ", 6578],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.911885318698495*^9, {3.911885401721641*^9, 3.9118854092154503`*^9}, 
   3.9118861747793217`*^9, 3.913181192106979*^9, 3.914912080820002*^9, 
   3.914923387486573*^9, 3.914924726695859*^9, 3.9149269561615267`*^9, 
   3.9149269935312147`*^9, 3.9149284116654053`*^9, 3.9149291607210712`*^9, 
   3.9149308649394197`*^9, 3.91493152886933*^9, 3.914931877101061*^9, 
   3.914933742273327*^9, 3.9149982810920258`*^9, 3.915080493640911*^9, 
   3.915524693575439*^9, 3.915532804301742*^9, 3.91553523002774*^9, 
   3.915598810048935*^9, 3.91561576683083*^9, 3.915618641466449*^9, 
   3.9156188578837147`*^9, 3.915685414689365*^9, 3.915690500227026*^9, 
   3.915692546296545*^9, 3.91569281653645*^9, 3.915785895405819*^9, 
   3.915787457798031*^9, 3.915788351683514*^9, 3.915793180484275*^9, 
   3.915859591041629*^9, 3.915873453102084*^9, 3.915873618239637*^9, 
   3.915874523706644*^9, 3.915875371332829*^9, 3.915875545134865*^9, 
   3.915875634762251*^9, 3.916121605527873*^9, 3.9162050204520693`*^9, 
   3.916205603369116*^9, {3.9162081471784773`*^9, 3.916208175501185*^9}, 
   3.916208293953074*^9, 3.91624625887817*^9, 3.916290751634116*^9, 
   3.916311168631763*^9, 3.916326537279353*^9, 3.9163348108051167`*^9, 
   3.9163699960623417`*^9, 3.916375421153182*^9, 3.916375596587727*^9, 
   3.916380391396881*^9, 3.9163875642653646`*^9, 3.9164033734324913`*^9, 
   3.916463338356257*^9, 3.918280482598735*^9, 3.918281050648543*^9, 
   3.9182815999107533`*^9, 3.9182826419582357`*^9, 3.918624486949935*^9, 
   3.919916128551547*^9, 3.9201796068558207`*^9, 3.92018579274296*^9, 
   3.920186935048012*^9, 3.920189132487297*^9, 3.92019466836754*^9, 
   3.9201952367582903`*^9, 3.920279918345539*^9, 3.9205238288740873`*^9, 
   3.921683198057407*^9, 3.921683232510256*^9, 3.921684836617652*^9, 
   3.92168814037636*^9, 3.9223306652889233`*^9, 3.923629806510817*^9, 
   3.924508130861932*^9, 3.924509058078888*^9, 3.9245223085678053`*^9, 
   3.924688373005506*^9, 3.924690900900559*^9, 3.924693787032016*^9, 
   3.924694667876152*^9, 3.924698440375465*^9, 3.924699598940069*^9, {
   3.924702850200951*^9, 3.924702852040079*^9}, 3.924703763303728*^9, 
   3.924789819159883*^9, 3.9247910534848213`*^9, 3.924791206913167*^9, 
   3.924791383544145*^9, {3.924791417628668*^9, 3.924791446837488*^9}, 
   3.924877972512982*^9, 3.924878021690049*^9, 3.924880722830433*^9, 
   3.924880767711467*^9, 3.92492354674504*^9, 3.924924541307807*^9, 
   3.924924931354887*^9, 3.924928975385746*^9, 3.924929453380536*^9, 
   3.924930183626802*^9, 3.92493032447122*^9, 3.92493064212709*^9, 
   3.924939955862052*^9, 3.925035200183689*^9, 3.925037334487811*^9, 
   3.925037423796852*^9, 3.925128964576128*^9, 3.925180149402885*^9, 
   3.925182390435404*^9, 3.925183335032819*^9, 3.9251887126778307`*^9, 
   3.92518896829587*^9, 3.925189152949016*^9, 3.925189406725477*^9, 
   3.925190561084693*^9, 3.9251938005732*^9, 3.9252751688648643`*^9, 
   3.925289182008292*^9, 3.925290389774982*^9, 3.925291369834865*^9, 
   3.9252919235372143`*^9, 3.925294282859178*^9, 3.925535094256988*^9, 
   3.925535925844879*^9, 3.9255438691304493`*^9, 3.926431164729772*^9, 
   3.92643286084614*^9, 3.9264361576753883`*^9, 3.92764860599935*^9, 
   3.927814672162487*^9, 3.9278676888973837`*^9, 3.92786969401515*^9, 
   3.928080988410194*^9, 3.9281353297117777`*^9, 3.928165155947977*^9, 
   3.928337831526894*^9, 3.928338780270903*^9, 3.928339716385118*^9, 
   3.928852260018196*^9, 3.930229847411872*^9, 3.930229944078471*^9, 
   3.930229981204928*^9, 3.930230024002837*^9},
 CellLabel->
  "During evaluation of \
In[344]:=",ExpressionUUID->"b1e07baf-074c-43b7-8d98-b3ce0e4a647f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Length of 2nd order RR expression = \"\>", "\[InvisibleSpace]",
    "11519"}],
  SequenceForm["Length of 2nd order RR expression = ", 11519],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.911885318698495*^9, {3.911885401721641*^9, 3.9118854092154503`*^9}, 
   3.9118861747793217`*^9, 3.913181192106979*^9, 3.914912080820002*^9, 
   3.914923387486573*^9, 3.914924726695859*^9, 3.9149269561615267`*^9, 
   3.9149269935312147`*^9, 3.9149284116654053`*^9, 3.9149291607210712`*^9, 
   3.9149308649394197`*^9, 3.91493152886933*^9, 3.914931877101061*^9, 
   3.914933742273327*^9, 3.9149982810920258`*^9, 3.915080493640911*^9, 
   3.915524693575439*^9, 3.915532804301742*^9, 3.91553523002774*^9, 
   3.915598810048935*^9, 3.91561576683083*^9, 3.915618641466449*^9, 
   3.9156188578837147`*^9, 3.915685414689365*^9, 3.915690500227026*^9, 
   3.915692546296545*^9, 3.91569281653645*^9, 3.915785895405819*^9, 
   3.915787457798031*^9, 3.915788351683514*^9, 3.915793180484275*^9, 
   3.915859591041629*^9, 3.915873453102084*^9, 3.915873618239637*^9, 
   3.915874523706644*^9, 3.915875371332829*^9, 3.915875545134865*^9, 
   3.915875634762251*^9, 3.916121605527873*^9, 3.9162050204520693`*^9, 
   3.916205603369116*^9, {3.9162081471784773`*^9, 3.916208175501185*^9}, 
   3.916208293953074*^9, 3.91624625887817*^9, 3.916290751634116*^9, 
   3.916311168631763*^9, 3.916326537279353*^9, 3.9163348108051167`*^9, 
   3.9163699960623417`*^9, 3.916375421153182*^9, 3.916375596587727*^9, 
   3.916380391396881*^9, 3.9163875642653646`*^9, 3.9164033734324913`*^9, 
   3.916463338356257*^9, 3.918280482598735*^9, 3.918281050648543*^9, 
   3.9182815999107533`*^9, 3.9182826419582357`*^9, 3.918624486949935*^9, 
   3.919916128551547*^9, 3.9201796068558207`*^9, 3.92018579274296*^9, 
   3.920186935048012*^9, 3.920189132487297*^9, 3.92019466836754*^9, 
   3.9201952367582903`*^9, 3.920279918345539*^9, 3.9205238288740873`*^9, 
   3.921683198057407*^9, 3.921683232510256*^9, 3.921684836617652*^9, 
   3.92168814037636*^9, 3.9223306652889233`*^9, 3.923629806510817*^9, 
   3.924508130861932*^9, 3.924509058078888*^9, 3.9245223085678053`*^9, 
   3.924688373005506*^9, 3.924690900900559*^9, 3.924693787032016*^9, 
   3.924694667876152*^9, 3.924698440375465*^9, 3.924699598940069*^9, {
   3.924702850200951*^9, 3.924702852040079*^9}, 3.924703763303728*^9, 
   3.924789819159883*^9, 3.9247910534848213`*^9, 3.924791206913167*^9, 
   3.924791383544145*^9, {3.924791417628668*^9, 3.924791446837488*^9}, 
   3.924877972512982*^9, 3.924878021690049*^9, 3.924880722830433*^9, 
   3.924880767711467*^9, 3.92492354674504*^9, 3.924924541307807*^9, 
   3.924924931354887*^9, 3.924928975385746*^9, 3.924929453380536*^9, 
   3.924930183626802*^9, 3.92493032447122*^9, 3.92493064212709*^9, 
   3.924939955862052*^9, 3.925035200183689*^9, 3.925037334487811*^9, 
   3.925037423796852*^9, 3.925128964576128*^9, 3.925180149402885*^9, 
   3.925182390435404*^9, 3.925183335032819*^9, 3.9251887126778307`*^9, 
   3.92518896829587*^9, 3.925189152949016*^9, 3.925189406725477*^9, 
   3.925190561084693*^9, 3.9251938005732*^9, 3.9252751688648643`*^9, 
   3.925289182008292*^9, 3.925290389774982*^9, 3.925291369834865*^9, 
   3.9252919235372143`*^9, 3.925294282859178*^9, 3.925535094256988*^9, 
   3.925535925844879*^9, 3.9255438691304493`*^9, 3.926431164729772*^9, 
   3.92643286084614*^9, 3.9264361576753883`*^9, 3.92764860599935*^9, 
   3.927814672162487*^9, 3.9278676888973837`*^9, 3.92786969401515*^9, 
   3.928080988410194*^9, 3.9281353297117777`*^9, 3.928165155947977*^9, 
   3.928337831526894*^9, 3.928338780270903*^9, 3.928339716385118*^9, 
   3.928852260018196*^9, 3.930229847411872*^9, 3.930229944078471*^9, 
   3.930229981204928*^9, 3.930230024179206*^9},
 CellLabel->
  "During evaluation of \
In[344]:=",ExpressionUUID->"dc6bb522-2b07-4137-b187-bcfcfcac8eb5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Length of 2nd order WA expression = \"\>", "\[InvisibleSpace]",
    "4036"}],
  SequenceForm["Length of 2nd order WA expression = ", 4036],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.911885318698495*^9, {3.911885401721641*^9, 3.9118854092154503`*^9}, 
   3.9118861747793217`*^9, 3.913181192106979*^9, 3.914912080820002*^9, 
   3.914923387486573*^9, 3.914924726695859*^9, 3.9149269561615267`*^9, 
   3.9149269935312147`*^9, 3.9149284116654053`*^9, 3.9149291607210712`*^9, 
   3.9149308649394197`*^9, 3.91493152886933*^9, 3.914931877101061*^9, 
   3.914933742273327*^9, 3.9149982810920258`*^9, 3.915080493640911*^9, 
   3.915524693575439*^9, 3.915532804301742*^9, 3.91553523002774*^9, 
   3.915598810048935*^9, 3.91561576683083*^9, 3.915618641466449*^9, 
   3.9156188578837147`*^9, 3.915685414689365*^9, 3.915690500227026*^9, 
   3.915692546296545*^9, 3.91569281653645*^9, 3.915785895405819*^9, 
   3.915787457798031*^9, 3.915788351683514*^9, 3.915793180484275*^9, 
   3.915859591041629*^9, 3.915873453102084*^9, 3.915873618239637*^9, 
   3.915874523706644*^9, 3.915875371332829*^9, 3.915875545134865*^9, 
   3.915875634762251*^9, 3.916121605527873*^9, 3.9162050204520693`*^9, 
   3.916205603369116*^9, {3.9162081471784773`*^9, 3.916208175501185*^9}, 
   3.916208293953074*^9, 3.91624625887817*^9, 3.916290751634116*^9, 
   3.916311168631763*^9, 3.916326537279353*^9, 3.9163348108051167`*^9, 
   3.9163699960623417`*^9, 3.916375421153182*^9, 3.916375596587727*^9, 
   3.916380391396881*^9, 3.9163875642653646`*^9, 3.9164033734324913`*^9, 
   3.916463338356257*^9, 3.918280482598735*^9, 3.918281050648543*^9, 
   3.9182815999107533`*^9, 3.9182826419582357`*^9, 3.918624486949935*^9, 
   3.919916128551547*^9, 3.9201796068558207`*^9, 3.92018579274296*^9, 
   3.920186935048012*^9, 3.920189132487297*^9, 3.92019466836754*^9, 
   3.9201952367582903`*^9, 3.920279918345539*^9, 3.9205238288740873`*^9, 
   3.921683198057407*^9, 3.921683232510256*^9, 3.921684836617652*^9, 
   3.92168814037636*^9, 3.9223306652889233`*^9, 3.923629806510817*^9, 
   3.924508130861932*^9, 3.924509058078888*^9, 3.9245223085678053`*^9, 
   3.924688373005506*^9, 3.924690900900559*^9, 3.924693787032016*^9, 
   3.924694667876152*^9, 3.924698440375465*^9, 3.924699598940069*^9, {
   3.924702850200951*^9, 3.924702852040079*^9}, 3.924703763303728*^9, 
   3.924789819159883*^9, 3.9247910534848213`*^9, 3.924791206913167*^9, 
   3.924791383544145*^9, {3.924791417628668*^9, 3.924791446837488*^9}, 
   3.924877972512982*^9, 3.924878021690049*^9, 3.924880722830433*^9, 
   3.924880767711467*^9, 3.92492354674504*^9, 3.924924541307807*^9, 
   3.924924931354887*^9, 3.924928975385746*^9, 3.924929453380536*^9, 
   3.924930183626802*^9, 3.92493032447122*^9, 3.92493064212709*^9, 
   3.924939955862052*^9, 3.925035200183689*^9, 3.925037334487811*^9, 
   3.925037423796852*^9, 3.925128964576128*^9, 3.925180149402885*^9, 
   3.925182390435404*^9, 3.925183335032819*^9, 3.9251887126778307`*^9, 
   3.92518896829587*^9, 3.925189152949016*^9, 3.925189406725477*^9, 
   3.925190561084693*^9, 3.9251938005732*^9, 3.9252751688648643`*^9, 
   3.925289182008292*^9, 3.925290389774982*^9, 3.925291369834865*^9, 
   3.9252919235372143`*^9, 3.925294282859178*^9, 3.925535094256988*^9, 
   3.925535925844879*^9, 3.9255438691304493`*^9, 3.926431164729772*^9, 
   3.92643286084614*^9, 3.9264361576753883`*^9, 3.92764860599935*^9, 
   3.927814672162487*^9, 3.9278676888973837`*^9, 3.92786969401515*^9, 
   3.928080988410194*^9, 3.9281353297117777`*^9, 3.928165155947977*^9, 
   3.928337831526894*^9, 3.928338780270903*^9, 3.928339716385118*^9, 
   3.928852260018196*^9, 3.930229847411872*^9, 3.930229944078471*^9, 
   3.930229981204928*^9, 3.930230024252472*^9},
 CellLabel->
  "During evaluation of \
In[344]:=",ExpressionUUID->"00759521-8924-4c7b-9486-b4e466174ebf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get first order effects - expand and go to fourier space", "Subsection",
 CellChangeTimes->{{3.927869991364188*^9, 
  3.927870035218254*^9}},ExpressionUUID->"61e7fb75-2bb4-4edf-82b6-\
0f65c85eaff5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Get", " ", "1", "st", " ", "order", " ", "wide"}], "-", 
    RowBox[{"angle", " ", "derivative", " ", "terms", " ", "expansions"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bkdict", "[", "\"\<WA1\>\"", "]"}], "=", " ", 
     RowBox[{"sortdotproducts1", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "NWA1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bkdict", "[", "\"\<RR1\>\"", "]"}], "=", " ", 
     RowBox[{"sortdotproducts1", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "NRR1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"so", " ", "second", " ", "order", " ", "effects"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bkdict", "[", "\"\<WAGR\>\"", "]"}], " ", "=", 
     RowBox[{
      RowBox[{"sortdotproducts1", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "WAGR"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"H", "->", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bkdict", "[", "\"\<RRGR\>\"", "]"}], " ", "=", 
     RowBox[{
      RowBox[{"sortdotproducts1", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "RRGR"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"H", "->", "1"}], "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.9202662192355223`*^9, {3.921683202923077*^9, 3.92168320322229*^9}, {
   3.9278675845552273`*^9, 3.927867632079731*^9}, {3.92786769360176*^9, 
   3.927867694661392*^9}, 3.930229950924417*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"54374c87-1236-4f54-8fa9-d6f2a6c0b24b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bkdict", "[", "\"\<WA1\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.9302299534051647`*^9, {3.930230033847184*^9, 3.9302300695686293`*^9}, {
   3.930230121672332*^9, 3.930230136960829*^9}, 3.931506707773988*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"6981144b-f23a-4138-9f84-a749c7f0dae6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Get  multipoles of the bispectrum", "Section"]], \
"Subsection",
 CellChangeTimes->{{3.920265971757719*^9, 3.9202659906442633`*^9}, {
  3.927867389456678*^9, 
  3.927867423364284*^9}},ExpressionUUID->"5c467482-4267-44cf-a83d-\
adfd1e189971"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"integrate", " ", "for", " ", "multipoles"}], ",", " ", 
    RowBox[{
    "then", " ", "seperate", " ", "into", " ", "lists", " ", "for", " ", 
     "easier", " ", "mathematica", " ", "simplification", " ", "and", " ", 
     "export"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getbklmfast", "[", 
    RowBox[{"l_", ",", "m_", ",", "key_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bktmp", " ", "=", 
       RowBox[{"preparesimplists2", "[", 
        RowBox[{
         RowBox[{"bkdict", "[", "key", "]"}], ",", "l", ",", "m"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"bktmplist", "=", 
       RowBox[{"simplifylist", "[", "bktmp", "]"}]}], ";", 
      RowBox[{"(*", "simplifylistharsh", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\</home/chris/Documents/Wolfram Mathematica/P\>\"", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"ToString", "/@", "perm"}], "]"}], ",", "\"\<l\>\"", ",", 
          RowBox[{"ToString", "[", "l", "]"}], ",", "\"\<m\>\"", ",", 
          RowBox[{"ToString", "[", "m", "]"}], ",", "key", ",", 
          "\"\<.json\>\""}], "]"}], ",", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Plus", " ", "@@", "bktmplist"}], ",", "InputForm"}], "]"}],
         ",", "\"\<JSON\>\""}], "]"}], ";"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.9278673946950417`*^9, 3.927868234495933*^9, {3.9288523044554777`*^9, 
   3.928852307363678*^9}, {3.939880441280839*^9, 3.939880441896896*^9}, 
   3.939881260941977*^9, {3.939944145326363*^9, 
   3.939944169122096*^9}},ExpressionUUID->"9c43df66-4f8d-42e7-b417-\
31b1553f3186"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["For first order WS terms ", "Subsection"]], \
"Subsubsection",
 CellChangeTimes->{{3.915529490174849*^9, 3.9155295035681143`*^9}, {
  3.92026602150168*^9, 
  3.9202660299073133`*^9}},ExpressionUUID->"251e469a-ccab-41ed-9e2b-\
3d591cb1ce27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getbklmfast", "[", 
  RowBox[{"1", ",", "1", ",", "\"\<RR1\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9283378509088497`*^9, 3.928337854344925*^9}, 
   3.939944174250042*^9},ExpressionUUID->"05b7f97d-f1aa-4753-97ae-\
6fe3522768f5"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "74.710059`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "9086"}],
  SequenceForm[
  "Integration time=", 74.710059, "; Number of terms in the expression: ", 
   9086],
  Editable->False]], "Print",
 CellChangeTimes->{3.928337908690193*^9, 3.928338844920025*^9, 
  3.928339808725069*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"6ce434b9-a120-4c65-a940-748208b8a8db"],

Cell[BoxData["156.284355`"], "Print",
 CellChangeTimes->{3.928337908690193*^9, 3.928338844920025*^9, 
  3.928339982753717*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"518b3816-8f08-4d42-83e2-2164616444dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<=", "3"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"getbklmfast", "[", 
    RowBox[{"3", ",", "i", " ", ",", "\"\<WA1\>\""}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<=", "3"}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"getbklmfast", "[", 
    RowBox[{"3", ",", "i", " ", ",", "\"\<RR1\>\""}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.928338660256044*^9, 3.928338726478723*^9}, {
  3.9399441778999243`*^9, 
  3.9399441784773817`*^9}},ExpressionUUID->"b992ab02-232b-436c-9361-\
d17f9aab34e1"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "38.870419`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "4570"}],
  SequenceForm[
  "Integration time=", 38.870419, "; Number of terms in the expression: ", 
   4570],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340021236994*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"296a4877-bce8-429f-81b4-bb571077cf2f"],

Cell[BoxData["58.93989`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340087658231*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"1148e2cf-8dbe-4583-8d80-d2f29381c841"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "51.570455`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "3486"}],
  SequenceForm[
  "Integration time=", 51.570455, "; Number of terms in the expression: ", 
   3486],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340138509474*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"f83f4ad2-d472-4c52-9aea-d7aeb9089c30"],

Cell[BoxData["50.36767`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340196147751*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"d32875f0-0f08-4aa5-8245-91177429b9bf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "33.842989`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "2259"}],
  SequenceForm[
  "Integration time=", 33.842989, "; Number of terms in the expression: ", 
   2259],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340229598969*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"c02062bd-7896-4429-ba0f-3f5c96dd3777"],

Cell[BoxData["33.112245`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.9283402692741737`*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"4220d2bf-4bad-4240-8869-de72cf218ac0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "33.776504`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "1470"}],
  SequenceForm[
  "Integration time=", 33.776504, "; Number of terms in the expression: ", 
   1470],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.9283403025169287`*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"79dfdaca-0c72-41cd-9c88-90de8dda60ec"],

Cell[BoxData["20.365688`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.9283403260862226`*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"a5f79e54-e9ad-4b68-b605-f06bf32c7553"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "73.749701`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "11470"}],
  SequenceForm[
  "Integration time=", 73.749701, "; Number of terms in the expression: ", 
   11470],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340399396264*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"f12f0431-1930-4962-975a-275adae165a4"],

Cell[BoxData["211.910727`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340630777322*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"1a6dcf05-03e0-4b39-8e17-5c79b6d688aa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "99.758856`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "8747"}],
  SequenceForm[
  "Integration time=", 99.758856, "; Number of terms in the expression: ", 
   8747],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.9283407298419247`*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"daf0bf4e-cd6b-4444-92b2-07972dec9e91"],

Cell[BoxData["173.993454`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928340923276648*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"410a75ee-0bb6-4f6f-b175-84b91fe10503"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "67.148626`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "5673"}],
  SequenceForm[
  "Integration time=", 67.148626, "; Number of terms in the expression: ", 
   5673],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.92834099002687*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"37bffb2c-1a91-4589-81ec-b4fe2aca64eb"],

Cell[BoxData["120.389202`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928341128539904*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"c6cf31af-7932-4303-b7e6-1daff8907b64"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "60.859148`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "3598"}],
  SequenceForm[
  "Integration time=", 60.859148, "; Number of terms in the expression: ", 
   3598],
  Editable->False]], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.928341188863929*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"318174be-608e-49c2-9374-32d2b01e4667"],

Cell[BoxData["68.923848`"], "Print",
 CellChangeTimes->{3.928339011650303*^9, 3.9283412662958927`*^9},
 CellLabel->
  "During evaluation of \
In[104]:=",ExpressionUUID->"e1bb7b21-2529-4064-9a81-6cba1cd2eff0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getbklmfast", "[", 
  RowBox[{"3", ",", "3", " ", ",", "\"\<WA1\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getbklmfast", "[", 
  RowBox[{"3", ",", "3", ",", "\"\<RR1\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.927826169499803*^9, 3.927826181690572*^9}, {
   3.927826248532167*^9, 3.9278262585841846`*^9}, {3.927826339151712*^9, 
   3.927826341098957*^9}, {3.9278272904997187`*^9, 3.927827301935464*^9}, {
   3.927827435074366*^9, 3.927827445006958*^9}, {3.9278277230726*^9, 
   3.927827724740902*^9}, {3.927869138560322*^9, 3.927869143220491*^9}, {
   3.9278704258097153`*^9, 3.927870427002059*^9}, {3.927870596810048*^9, 
   3.9278705980031557`*^9}, {3.927871119860525*^9, 3.927871121030023*^9}, {
   3.928337865707913*^9, 3.92833786755225*^9}, 3.928338093505948*^9, {
   3.9283383857423267`*^9, 3.928338386877222*^9}, {3.928338609039194*^9, 
   3.928338610000607*^9}, {3.928338698640472*^9, 3.928338699723297*^9}, {
   3.9399441758181267`*^9, 
   3.939944176708799*^9}},ExpressionUUID->"ddabd1b6-626f-4566-a9b8-\
b9951a6288e0"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "14.29784`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "570"}],
  SequenceForm[
  "Integration time=", 14.29784, "; Number of terms in the expression: ", 570],
  Editable->False]], "Print",
 CellChangeTimes->{3.927869170244143*^9, 3.927869741089779*^9, 
  3.9278704580854187`*^9, 3.9278706298976917`*^9, 3.92788028992705*^9, 
  3.9283380313112288`*^9, 3.9283384089863567`*^9, 3.928338627207201*^9, 
  3.928338713966173*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"6451865e-45f9-492f-80a9-1ab9407118e9"],

Cell[BoxData["4.515978`"], "Print",
 CellChangeTimes->{3.927869170244143*^9, 3.927869741089779*^9, 
  3.9278704580854187`*^9, 3.9278706298976917`*^9, 3.92788028992705*^9, 
  3.9283380313112288`*^9, 3.9283384089863567`*^9, 3.928338627207201*^9, 
  3.9283387192107983`*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"90ef60f3-bd18-411b-95ed-ab72b5017b98"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "28.796486`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "1474"}],
  SequenceForm[
  "Integration time=", 28.796486, "; Number of terms in the expression: ", 
   1474],
  Editable->False]], "Print",
 CellChangeTimes->{3.927869170244143*^9, 3.927869741089779*^9, 
  3.9278704580854187`*^9, 3.9278706298976917`*^9, 3.92788028992705*^9, 
  3.9283380313112288`*^9, 3.9283384089863567`*^9, 3.928338627207201*^9, 
  3.928338747524069*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"c0cd0923-f50a-4c1e-a217-d86bae6b4593"],

Cell[BoxData["18.818238`"], "Print",
 CellChangeTimes->{3.927869170244143*^9, 3.927869741089779*^9, 
  3.9278704580854187`*^9, 3.9278706298976917`*^9, 3.92788028992705*^9, 
  3.9283380313112288`*^9, 3.9283384089863567`*^9, 3.928338627207201*^9, 
  3.928338768892915*^9},
 CellLabel->
  "During evaluation of \
In[42]:=",ExpressionUUID->"3262e948-7d20-4f86-84ae-c298e744b0f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getbklmfast", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<WAGR\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getbklmfast", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<RRGR\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.927827448095112*^9, 3.927827464055376*^9}, {
  3.93994418025786*^9, 
  3.93994418086511*^9}},ExpressionUUID->"9ead8603-e4b9-481c-b71f-\
1dfbb673776b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "24.978815`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "3028"}],
  SequenceForm[
  "Integration time=", 24.978815, "; Number of terms in the expression: ", 
   3028],
  Editable->False]], "Print",
 CellChangeTimes->{3.9278275006667233`*^9, 3.9278275703857117`*^9, 
  3.928081068034227*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"f09e19d9-faac-4ec4-b8b8-5f86dd6d26c1"],

Cell[BoxData["32.685321`"], "Print",
 CellChangeTimes->{3.9278275006667233`*^9, 3.9278275703857117`*^9, 
  3.928081101936513*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"65083733-09c6-4baa-a94c-b61aed94a86a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration time=\"\>", "\[InvisibleSpace]", "26.379114`", 
   "\[InvisibleSpace]", "\<\"; Number of terms in the expression: \"\>", 
   "\[InvisibleSpace]", "9064"}],
  SequenceForm[
  "Integration time=", 26.379114, "; Number of terms in the expression: ", 
   9064],
  Editable->False]], "Print",
 CellChangeTimes->{3.9278275006667233`*^9, 3.9278275703857117`*^9, 
  3.928081127935919*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"d7a9eea9-eacb-4db7-8a19-49bca8214e37"],

Cell[BoxData["149.413362`"], "Print",
 CellChangeTimes->{3.9278275006667233`*^9, 3.9278275703857117`*^9, 
  3.928081280708314*^9},
 CellLabel->
  "During evaluation of \
In[38]:=",ExpressionUUID->"3dcf5ada-9e1a-4538-a5bb-e187b853fbb6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For these second order WS - this can take a while due to the sheer number of \
terms...\
\>", "Subsection",
 CellChangeTimes->{{3.9278698842872343`*^9, 
  3.927869902691338*^9}},ExpressionUUID->"726470c0-dbba-4cb6-96de-\
02dc4926cade"],

Cell[BoxData[{
 RowBox[{"bkWA2", "=", 
  RowBox[{"Timing", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"sortdotproducts2", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "^", "2"}], " ", "NWA2"}],
      "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bkdict", "[", "\"\<WA2\>\"", "]"}], " ", "=", " ", 
  "bkWA2"}]}], "Input",
 CellChangeTimes->{
  3.927869913082685*^9},ExpressionUUID->"80c2ab7f-ac14-44e3-a069-\
c3a5a8ad5241"],

Cell[BoxData[{
 RowBox[{"bkRR2", "=", 
  RowBox[{"Timing", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"sortdotproducts2", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "^", "2"}], "NRR2"}], 
     "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bkdict", "[", "\"\<RR2\>\"", "]"}], " ", "=", " ", 
  "bkRR2"}]}], "Input",
 CellChangeTimes->{
  3.9278699244301853`*^9},ExpressionUUID->"306f8103-9a91-44d6-83e8-\
e31e502689c2"],

Cell[BoxData[{
 RowBox[{"bkWARR", " ", "=", 
  RowBox[{"Timing", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"sortdotproducts2", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "/", "d"}], ")"}], "^", "2"}], "NWARR"}], 
     "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bkdict", "[", "\"\<WARR\>\"", "]"}], " ", "=", " ", 
  "bkWARR"}]}], "Input",
 CellChangeTimes->{
  3.9278699327745037`*^9},ExpressionUUID->"06ce285a-41d7-421f-a2c2-\
814e65d63073"],

Cell[CellGroupData[{

Cell["\<\
Get second order multipoles (is time consuming particularly RR2)\
\>", "Subsubsection",
 CellChangeTimes->{{3.92786818568102*^9, 3.927868209685803*^9}, {
  3.927869943714123*^9, 
  3.9278699551345663`*^9}},ExpressionUUID->"74d13250-707b-4896-ad23-\
c6956b8f0592"],

Cell[BoxData[
 RowBox[{"getbklm", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<WA2\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.927868281484309*^9, 
  3.927868283899558*^9}},ExpressionUUID->"07fd06a1-69a7-4ea7-95d9-\
1e5d14f91266"],

Cell[BoxData[
 RowBox[{"getbklm", "[", 
  RowBox[{"0", ",", "0", ",", "\"\<WARR\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.927868279364751*^9, 
  3.927868288751678*^9}},ExpressionUUID->"6cf59bda-0cd7-4f13-bc21-\
4997fc778cc5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getbklm", "[", 
     RowBox[{"0", ",", "0", ",", "\"\<RR2\>\""}], "]"}], "bktmp"}], " ", "=", 
   
   RowBox[{"simplifyexprharsh", "[", 
    RowBox[{
     RowBox[{"bkdict", "[", "key", "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"C", "->", 
        RowBox[{"3", "/", "7"}]}], ",", 
       RowBox[{"K", "->", 
        RowBox[{"3", "/", "7"}]}], ",", 
       RowBox[{"amu", " ", "->", " ", "mu"}], ",", 
       RowBox[{"amu2", "->", "mu2"}], ",", 
       RowBox[{"\[Eta]", "->", "mu"}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], "->", "cosphi"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bklist", " ", "=", 
  RowBox[{"Timing", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"Simplify", ",", "bktmp"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.911543221998396*^9, {3.911543559092518*^9, 3.9115435659322968`*^9}, 
   3.9115607537043123`*^9, {3.911561407928322*^9, 3.9115614357748613`*^9}, {
   3.911561528354085*^9, 3.911561534000005*^9}, 3.915005971365527*^9, {
   3.915006497737969*^9, 3.91500650851021*^9}, {3.915008042507352*^9, 
   3.91500808333981*^9}, 3.9151045408037558`*^9, {3.915125517835397*^9, 
   3.915125521490026*^9}, {3.915532221059417*^9, 3.915532251980486*^9}, {
   3.915532298268894*^9, 3.915532338189539*^9}, {3.915534684113989*^9, 
   3.915534695233884*^9}, {3.915784142375936*^9, 3.915784148704698*^9}, {
   3.91622849728771*^9, 3.9162285030794086`*^9}, {3.916228582909226*^9, 
   3.916228597501444*^9}, {3.916363385099586*^9, 3.91636338581383*^9}, 
   3.924933782474901*^9, {3.9255351764153423`*^9, 3.925535184227542*^9}, 
   3.925535896020239*^9, {3.9278682494590683`*^9, 3.927868276983638*^9}, 
   3.931499580230143*^9},ExpressionUUID->"4bb5ef24-fa51-4637-9f99-\
8f8d46ce6845"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["So if we just want full local bispectrum...", "Section",
 CellChangeTimes->{{3.927870094003789*^9, 
  3.927870094762081*^9}},ExpressionUUID->"571ca216-7e19-456e-b186-\
7e2129b190f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getbk", "[", "key_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bktmp", " ", "=", 
      RowBox[{"simplifyexpr", "[", 
       RowBox[{
        RowBox[{"bkdict", "[", "key", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"C", "->", 
           RowBox[{"3", "/", "7"}]}], ",", 
          RowBox[{"K", "->", 
           RowBox[{"3", "/", "7"}]}], ",", 
          RowBox[{"amu", " ", "->", " ", "mu"}], ",", 
          RowBox[{"amu2", "->", "mu2"}], ",", 
          RowBox[{"\[Eta]", "->", "mu"}], ",", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], "->", "cosphi"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bklist", " ", "=", 
      RowBox[{"Timing", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Simplify", ",", "bktmp"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"bklist", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\</home/chris/Documents/Wolfram Mathematica/P\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"ToString", "/@", "perm"}], "]"}], ",", "key", ",", 
         "\"\<.json\>\""}], "]"}], ",", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"Refine", "[", 
          RowBox[{"Plus", " ", "@@", 
           RowBox[{"bklist", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "InputForm"}], 
        "]"}], ",", "\"\<JSON\>\""}], "]"}], ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.930214420143609*^9, 3.930214547757476*^9}, {
   3.931508040101581*^9, 3.931508040176074*^9}, {3.93150807802113*^9, 
   3.931508095289115*^9}, {3.931508215340507*^9, 3.931508270613009*^9}, 
   3.931508808989428*^9, {3.9315088861908817`*^9, 3.931508919830139*^9}, {
   3.931509207565597*^9, 3.931509212885064*^9}, {3.932055226162737*^9, 
   3.932055226574885*^9}, {3.932055310376553*^9, 
   3.932055340193095*^9}},ExpressionUUID->"e9cf8630-aadd-41fa-96a3-\
295179c6ea2a"],

Cell[BoxData[{
 RowBox[{"getbk", "[", "\"\<WA1\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getbk", "[", "\"\<GR1\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getbk", "[", "\"\<GR2\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.930214559635231*^9, 3.930214570540935*^9}, {
  3.9315023687391443`*^9, 3.9315023802152653`*^9}, {3.931508064014221*^9, 
  3.9315080730044327`*^9}, {3.931508229361021*^9, 3.931508230031376*^9}, {
  3.931508795177717*^9, 3.9315087957481194`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"fe1cdd38-91f3-4aa4-9c84-407e24fc7776"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bkdict", "[", "\"\<GR0\>\"", "]"}]], "Input",
 CellChangeTimes->{3.9314996494270353`*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"e1abc254-145d-4f03-b63d-5f730a2aa830"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SuperscriptBox["D1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"b1", "+", 
    RowBox[{"f", " ", 
     SuperscriptBox["mu", "2"]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"b1", "+", 
    RowBox[{"f", " ", 
     SuperscriptBox["mu2", "2"]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["b2", "2"], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k1", " ", "mu"}], "+", 
       RowBox[{"k2", " ", "mu2"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["mu", "k1"], "+", 
          FractionBox["mu2", "k2"]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{"f", " ", "mu", " ", "mu2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", " ", "mu"}], "+", 
           RowBox[{"k2", " ", "mu2"}]}], ")"}]}], 
        RowBox[{"k1", " ", "k2"}]]}], ")"}]}], "+", 
    RowBox[{"g2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "theta", "]"}], "2"]}], ")"}]}], "+", 
    FractionBox[
     RowBox[{"f", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1", " ", "mu"}], "+", 
         RowBox[{"k2", " ", "mu2"}]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"C", "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["k1", "k2"], "+", 
           FractionBox["k2", "k1"]}], ")"}], " ", 
         RowBox[{"Cos", "[", "theta", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "C"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}], 
     SuperscriptBox["k3", "2"]], "+", 
    RowBox[{"b1", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "+", "K"}], "2"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["k1", "k2"], "+", 
          FractionBox["k2", "k1"]}], ")"}], " ", 
        RowBox[{"Cos", "[", "theta", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "K"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "theta", "]"}], "2"]}]}], ")"}]}]}], ")"}], " ", 
  
  RowBox[{"P", "[", "k1", "]"}], " ", 
  RowBox[{"P", "[", "k2", "]"}]}]], "Output",
 CellChangeTimes->{3.932055268247738*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"2d04b80d-c719-4572-8796-1d5c88271e49"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"26df3afd-cc73-4ac0-8e3b-eb4b7120c928"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1386, 762},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a80bb5ae-d434-4d84-803b-91639b67437e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 614, 9, 89, "Title",ExpressionUUID->"a6c2099a-8a82-468e-bcc6-ad0bbd958e12"],
Cell[1197, 33, 199, 4, 26, "Input",ExpressionUUID->"3bb6163f-4100-43ab-ad4a-b69079ba0a43"],
Cell[1399, 39, 2066, 43, 121, "Input",ExpressionUUID->"dcda73b0-e268-45e6-bd7c-0b1b8cfaa47a"],
Cell[3468, 84, 342, 9, 46, "Input",ExpressionUUID->"1c87efe0-a8b8-4f61-91be-bb2ac32b61f0"],
Cell[3813, 95, 2247, 52, 140, "Input",ExpressionUUID->"9b6b5457-a0c0-4c33-bffb-1bf5f6e86e7e"],
Cell[6063, 149, 1635, 44, 102, "Input",ExpressionUUID->"1495b172-a487-4abd-b2da-d7993145818c"],
Cell[CellGroupData[{
Cell[7723, 197, 463, 9, 60, "Section",ExpressionUUID->"c0e6cbef-970c-4837-831d-051d15eb6ea6"],
Cell[8189, 208, 6091, 122, 145, "Input",ExpressionUUID->"99e7f500-ed4e-4efd-8554-db7be3d27208"],
Cell[14283, 332, 1435, 43, 83, "Input",ExpressionUUID->"bd074f12-c520-49a4-888c-a02fb3916a6e"],
Cell[CellGroupData[{
Cell[15743, 379, 164, 3, 40, "Subsubsection",ExpressionUUID->"ad3720ee-1edd-4027-92cc-878e2f9f7e3f"],
Cell[CellGroupData[{
Cell[15932, 386, 372, 8, 45, "Input",ExpressionUUID->"85759cf2-e160-45d5-8e05-20d7c1ed9143"],
Cell[CellGroupData[{
Cell[16329, 398, 541, 13, 21, "Print",ExpressionUUID->"1b720a74-b44d-4c1d-a397-332324f2b591"],
Cell[16873, 413, 386, 9, 21, "Print",ExpressionUUID->"e59b05ea-c466-4e29-b5b3-c0042486f4ed"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17308, 428, 382, 11, 27, "Input",ExpressionUUID->"259b56aa-3695-4a24-b01f-4dde55a90c48"],
Cell[CellGroupData[{
Cell[17715, 443, 494, 12, 21, "Print",ExpressionUUID->"8cabe5db-9a11-46c8-a050-834841b571e5"],
Cell[18212, 457, 185, 4, 21, "Print",ExpressionUUID->"915ccec4-045f-4cd5-9a0a-76c627104f31"],
Cell[18400, 463, 494, 12, 21, "Print",ExpressionUUID->"1158beb9-62a2-4f95-b898-a1a47dc94d9d"],
Cell[18897, 477, 185, 4, 21, "Print",ExpressionUUID->"32083770-076d-4645-922a-90245259dbc5"],
Cell[19085, 483, 494, 12, 21, "Print",ExpressionUUID->"a8ed5f22-6e43-490f-923d-f2c3d0e3dfe6"],
Cell[19582, 497, 183, 4, 21, "Print",ExpressionUUID->"e97978e9-baa2-424e-bbf3-8c4b76080520"],
Cell[19768, 503, 494, 12, 21, "Print",ExpressionUUID->"353132c6-576c-4adf-9afb-3da2d7eaa060"],
Cell[20265, 517, 183, 4, 21, "Print",ExpressionUUID->"629b5e7d-1b05-4e67-9dce-e04e64985da4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20497, 527, 342, 7, 64, "Input",ExpressionUUID->"14c4617a-6ca8-436d-90ae-17592b562c00"],
Cell[CellGroupData[{
Cell[20864, 538, 490, 11, 21, "Print",ExpressionUUID->"277b717a-eddb-4a05-9b4c-05a1a19b029e"],
Cell[21357, 551, 185, 4, 21, "Print",ExpressionUUID->"e296ccad-7fdb-4686-bf49-3f44f6c9702c"],
Cell[21545, 557, 494, 12, 21, "Print",ExpressionUUID->"22e7ea59-a845-45ea-aed0-d5e15a62e631"],
Cell[22042, 571, 184, 4, 21, "Print",ExpressionUUID->"afb876e6-5b10-4fbe-939f-d615be2d1077"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22299, 583, 328, 5, 60, "Section",ExpressionUUID->"8c319aea-904a-44de-af21-b87a8dddc8f0"],
Cell[22630, 590, 215, 5, 31, "Text",ExpressionUUID->"0af5d70c-4fcf-49c3-8c97-fcdcba46befc"],
Cell[22848, 597, 5553, 138, 256, "Input",ExpressionUUID->"6ad7779a-ce06-48d8-812d-35fd00578542"],
Cell[28404, 737, 1942, 51, 65, "Input",ExpressionUUID->"9874e54e-f396-4dd2-8725-8564865261d5"],
Cell[30349, 790, 561, 10, 26, "Input",ExpressionUUID->"dd546e41-a0ba-41b9-9b3e-cc5436b453d5"],
Cell[CellGroupData[{
Cell[30935, 804, 255, 5, 26, "Input",ExpressionUUID->"16ea253e-28f2-45cb-8abd-8de1d9ee1c74"],
Cell[CellGroupData[{
Cell[31215, 813, 610, 14, 20, "Print",ExpressionUUID->"8da85b7c-3d0d-44b7-b046-3b90df89de02"],
Cell[31828, 829, 459, 10, 20, "Print",ExpressionUUID->"2ecbcf9d-95fd-4217-8c8d-2b56257e1ed9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32336, 845, 254, 5, 26, "Input",ExpressionUUID->"6ef72eac-5ede-436d-b9d5-1c2c8d77c7b8"],
Cell[CellGroupData[{
Cell[32615, 854, 577, 12, 20, "Print",ExpressionUUID->"d4778a38-9636-491f-a222-cc019f1d85f0"],
Cell[33195, 868, 432, 9, 20, "Print",ExpressionUUID->"0ae7b46f-f974-4864-855b-c84eca2b8000"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33676, 883, 307, 6, 26, "Input",ExpressionUUID->"1a0072d7-520a-46ca-aee6-918401584e01"],
Cell[CellGroupData[{
Cell[34008, 893, 700, 15, 20, "Print",ExpressionUUID->"b55cf6e6-7b8e-4a50-bea8-44574e02660a"],
Cell[34711, 910, 550, 11, 20, "Print",ExpressionUUID->"24e3cdfd-1d9c-49e5-a56b-059ea1eee3dd"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[35322, 928, 220, 4, 48, "Section",ExpressionUUID->"0a7b04ce-8476-4178-b78f-5ca777749257"],
Cell[CellGroupData[{
Cell[35567, 936, 4246, 122, 160, "Input",ExpressionUUID->"80450489-b12d-45a6-9465-07939a8709a9"],
Cell[39816, 1060, 17210, 459, 305, "Output",ExpressionUUID->"0107b63c-922c-413f-95b6-69b31b94511e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57075, 1525, 264, 4, 60, "Section",ExpressionUUID->"c6ffb7e9-e751-4183-b478-227b2e3901d1"],
Cell[57342, 1531, 282, 7, 31, "Text",ExpressionUUID->"d1c5b971-0a2b-42a7-8149-133896127bff"],
Cell[CellGroupData[{
Cell[57649, 1542, 318, 7, 40, "Subsubsection",ExpressionUUID->"ee7876c7-aa0e-4b34-9dcc-fbde48525c8f"],
Cell[57970, 1551, 4710, 137, 237, "Input",ExpressionUUID->"f4961d04-eed2-4be2-99ad-3f6138e7842f"],
Cell[62683, 1690, 1760, 38, 83, "Input",ExpressionUUID->"2f47b5f5-dfab-4d8c-b1b1-6274ae8c71eb"],
Cell[64446, 1730, 4442, 99, 177, "Input",ExpressionUUID->"c75526ad-f760-4879-ad06-19d79985ab29"],
Cell[CellGroupData[{
Cell[68913, 1833, 1417, 27, 65, "Input",ExpressionUUID->"58f36aad-b70a-41e5-920f-f00316a2b9ec"],
Cell[CellGroupData[{
Cell[70355, 1864, 3856, 59, 20, "Print",ExpressionUUID->"b1e07baf-074c-43b7-8d98-b3ce0e4a647f"],
Cell[74214, 1925, 3874, 59, 20, "Print",ExpressionUUID->"dc6bb522-2b07-4137-b187-bcfcfcac8eb5"],
Cell[78091, 1986, 3872, 59, 21, "Print",ExpressionUUID->"00759521-8924-4c7b-9486-b4e466174ebf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82024, 2052, 204, 3, 48, "Subsection",ExpressionUUID->"61e7fb75-2bb4-4edf-82b6-0f65c85eaff5"],
Cell[82231, 2057, 1885, 51, 127, "Input",ExpressionUUID->"54374c87-1236-4f54-8fa9-d6f2a6c0b24b"],
Cell[84119, 2110, 333, 6, 27, "Input",ExpressionUUID->"6981144b-f23a-4138-9f84-a749c7f0dae6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84489, 2121, 265, 5, 57, "Subsection",ExpressionUUID->"5c467482-4267-44cf-a83d-adfd1e189971"],
Cell[84757, 2128, 1875, 42, 120, "Input",ExpressionUUID->"9c43df66-4f8d-42e7-b417-31b1553f3186"],
Cell[CellGroupData[{
Cell[86657, 2174, 264, 5, 39, "Subsubsection",ExpressionUUID->"251e469a-ccab-41ed-9e2b-3d591cb1ce27"],
Cell[CellGroupData[{
Cell[86946, 2183, 258, 5, 25, "Input",ExpressionUUID->"05b7f97d-f1aa-4753-97ae-6fe3522768f5"],
Cell[CellGroupData[{
Cell[87229, 2192, 543, 13, 19, "Print",ExpressionUUID->"6ce434b9-a120-4c65-a940-748208b8a8db"],
Cell[87775, 2207, 232, 5, 19, "Print",ExpressionUUID->"518b3816-8f08-4d42-83e2-2164616444dd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88056, 2218, 702, 20, 45, "Input",ExpressionUUID->"b992ab02-232b-436c-9361-d17f9aab34e1"],
Cell[CellGroupData[{
Cell[88783, 2242, 518, 12, 19, "Print",ExpressionUUID->"296a4877-bce8-429f-81b4-bb571077cf2f"],
Cell[89304, 2256, 205, 4, 19, "Print",ExpressionUUID->"1148e2cf-8dbe-4583-8d80-d2f29381c841"],
Cell[89512, 2262, 518, 12, 19, "Print",ExpressionUUID->"f83f4ad2-d472-4c52-9aea-d7aeb9089c30"],
Cell[90033, 2276, 205, 4, 19, "Print",ExpressionUUID->"d32875f0-0f08-4aa5-8245-91177429b9bf"],
Cell[90241, 2282, 518, 12, 19, "Print",ExpressionUUID->"c02062bd-7896-4429-ba0f-3f5c96dd3777"],
Cell[90762, 2296, 208, 4, 19, "Print",ExpressionUUID->"4220d2bf-4bad-4240-8869-de72cf218ac0"],
Cell[90973, 2302, 520, 12, 19, "Print",ExpressionUUID->"79dfdaca-0c72-41cd-9c88-90de8dda60ec"],
Cell[91496, 2316, 208, 4, 19, "Print",ExpressionUUID->"a5f79e54-e9ad-4b68-b605-f06bf32c7553"],
Cell[91707, 2322, 520, 12, 19, "Print",ExpressionUUID->"f12f0431-1930-4962-975a-275adae165a4"],
Cell[92230, 2336, 207, 4, 19, "Print",ExpressionUUID->"1a6dcf05-03e0-4b39-8e17-5c79b6d688aa"],
Cell[92440, 2342, 520, 12, 19, "Print",ExpressionUUID->"daf0bf4e-cd6b-4444-92b2-07972dec9e91"],
Cell[92963, 2356, 207, 4, 19, "Print",ExpressionUUID->"410a75ee-0bb6-4f6f-b175-84b91fe10503"],
Cell[93173, 2362, 517, 12, 19, "Print",ExpressionUUID->"37bffb2c-1a91-4589-81ec-b4fe2aca64eb"],
Cell[93693, 2376, 207, 4, 19, "Print",ExpressionUUID->"c6cf31af-7932-4303-b7e6-1daff8907b64"],
Cell[93903, 2382, 518, 12, 19, "Print",ExpressionUUID->"318174be-608e-49c2-9374-32d2b01e4667"],
Cell[94424, 2396, 208, 4, 19, "Print",ExpressionUUID->"e1bb7b21-2529-4064-9a81-6cba1cd2eff0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[94681, 2406, 1067, 18, 41, "Input",ExpressionUUID->"ddabd1b6-626f-4566-a9b8-b9951a6288e0"],
Cell[CellGroupData[{
Cell[95773, 2428, 679, 14, 19, "Print",ExpressionUUID->"6451865e-45f9-492f-80a9-1ab9407118e9"],
Cell[96455, 2444, 376, 7, 19, "Print",ExpressionUUID->"90ef60f3-bd18-411b-95ed-ab72b5017b98"],
Cell[96834, 2453, 687, 15, 19, "Print",ExpressionUUID->"c0cd0923-f50a-4c1e-a217-d86bae6b4593"],
Cell[97524, 2470, 375, 7, 19, "Print",ExpressionUUID->"3262e948-7d20-4f86-84ae-c298e744b0f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97948, 2483, 395, 9, 45, "Input",ExpressionUUID->"9ead8603-e4b9-481c-b71f-1dfbb673776b"],
Cell[CellGroupData[{
Cell[98368, 2496, 546, 13, 19, "Print",ExpressionUUID->"f09e19d9-faac-4ec4-b8b8-5f86dd6d26c1"],
Cell[98917, 2511, 234, 5, 19, "Print",ExpressionUUID->"65083733-09c6-4baa-a94c-b61aed94a86a"],
Cell[99154, 2518, 546, 13, 19, "Print",ExpressionUUID->"d7a9eea9-eacb-4db7-8a19-49bca8214e37"],
Cell[99703, 2533, 235, 5, 19, "Print",ExpressionUUID->"3dcf5ada-9e1a-4538-a5bb-e187b853fbb6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100011, 2546, 245, 6, 46, "Subsection",ExpressionUUID->"726470c0-dbba-4cb6-96de-02dc4926cade"],
Cell[100259, 2554, 510, 15, 45, "Input",ExpressionUUID->"80c2ab7f-ac14-44e3-a069-c3a5a8ad5241"],
Cell[100772, 2571, 507, 15, 45, "Input",ExpressionUUID->"306f8103-9a91-44d6-83e8-e31e502689c2"],
Cell[101282, 2588, 516, 15, 45, "Input",ExpressionUUID->"06ce285a-41d7-421f-a2c2-814e65d63073"],
Cell[CellGroupData[{
Cell[101823, 2607, 273, 6, 39, "Subsubsection",ExpressionUUID->"74d13250-707b-4896-ad23-c6956b8f0592"],
Cell[102099, 2615, 229, 5, 25, "Input",ExpressionUUID->"07fd06a1-69a7-4ea7-95d9-1e5d14f91266"],
Cell[102331, 2622, 230, 5, 25, "Input",ExpressionUUID->"6cf59bda-0cd7-4f13-bc21-4997fc778cc5"],
Cell[102564, 2629, 1834, 40, 82, "Input",ExpressionUUID->"4bb5ef24-fa51-4637-9f99-8f8d46ce6845"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104459, 2676, 188, 3, 59, "Section",ExpressionUUID->"571ca216-7e19-456e-b186-7e2129b190f6"],
Cell[104650, 2681, 2210, 52, 176, "Input",ExpressionUUID->"e9cf8630-aadd-41fa-96a3-295179c6ea2a"],
Cell[106863, 2735, 554, 8, 64, "Input",ExpressionUUID->"fe1cdd38-91f3-4aa4-9c84-407e24fc7776"],
Cell[CellGroupData[{
Cell[107442, 2747, 192, 3, 25, "Input",ExpressionUUID->"e1abc254-145d-4f03-b63d-5f730a2aa830"],
Cell[107637, 2752, 2671, 84, 171, "Output",ExpressionUUID->"2d04b80d-c719-4572-8796-1d5c88271e49"]
}, Open  ]],
Cell[110323, 2839, 81, 0, 25, "Input",ExpressionUUID->"26df3afd-cc73-4ac0-8e3b-eb4b7120c928"]
}, Open  ]]
}, Open  ]]
}
]
*)

